---
title: "ุชุญููู ุจูุงูุงุช Bulk RNA-Seq ุจุงุณุชุฎุฏุงู R"
lang: "ar"
output:
  html_document:
    css: "../sc/style.css"
    df_print: paged
    toc: true
    toc_float: true
  pdf_document: default
editor_options:
  markdown:
    wrap: sentence
---

### ูุฑุดุฉ ุนูู ููุงูุฉ ููู 11 ุฃูุชูุจุฑ 2025 ูู ูุฏููุฉ ุฃูุณููุฑุฏ
### ูุฑุญุจ ุจุงูุชูุงุตู ูุนูู ูู ุฎูุงู ูุณุงุฆู ุงูุชูุงุตู ุงูุชุงููุฉ:
### [YouTube](http://www.youtube.com/@Dalah-info) | [X](https://x.com/Dalah_Info) | [LinkedIn](https://www.linkedin.com/company/dalah/) | [GitHub](https://github.com/Dalah-Info)

---

# ๐งฌ ููุฏูุฉ: ูุง ูู ุชุญููู ุงูู RNA-seqุ

## ูุง ุงูุฐู ูููุณู ูู ุชุฌุฑุจุฉ RNA-seqุ

ุชุญููู **RNA-seq** ูู ุฃุญุฏ ุฃูู ุงูุชูููุงุช ูู ุนูู ุงูุฌูููู ุงููุธูููุ  
ูููุณุชุฎุฏู ูููุงุณ **ูููุฉ ุงูุชุนุจูุฑ ุงูุฌููู** ููู ุฌูู ูู ุฎููุฉ ุฃู ูุณูุฌ.

ูู ูุฐู ุงูุชูููุฉุ ูุชู:

1. ุงุณุชุฎูุงุต ุงูู RNA ูู ุงูุนููุงุช (ูุซู ูุณูุฌ ุทุจูุนู ุฃู ูุณูุฌ ูุฑูู).  
2. ุชุญูููู ุฅูู cDNA ููุฑุงุกุฉ ุชุณูุณูู  
3. ุญุณุงุจ ุนุฏุฏ ุงููุฑุงุกุงุช (Reads) ุงูุชู ุชูุซู ูู ุฌูู ูู ูู ุนููุฉ.

> ๐ก ูุฐู ุงูุนุฏูุงุช ูู ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ ุงูุชู ุณูุญูููุง ุงูููู.

---

## ุงููุฑู ุจูู Bulk RNA-seq ูSingle-cell RNA-seq

| ุงูููุน | ุงููุฏู | ุงูุชุจุงูู | ููุงุญุธุงุช |
|-------|--------|----------|----------|
| **Bulk RNA-seq** | ููุงุณ ุงูุชุนุจูุฑ ุงููุชูุณุท ููุฌููุนุฉ ุฎูุงูุง (ูุซู ูุณูุฌ ูุงูู). | ูุง ููุธูุฑ ุชุจุงูู ุงูุฎูุงูุง ุงูููุฑุฏุฉ. | ูุณุชุฎุฏู ูู ุงูููุงุฑูุงุช ุจูู ุงููุฌููุนุงุช (ูุซู ุทุจูุนู ููุงุจู ูุฑูู). |
| **Single-cell RNA-seq** | ููุงุณ ุงูุชุนุจูุฑ ููู ุฎููุฉ ุนูู ุญุฏุฉ. | ููุดู ุงูุชุบุงูุฑ ุฏุงุฎู ุงููุณูุฌ. | ูุชุทูุจ ุชุญููููุง ุฃูุซุฑ ุชุนููุฏูุง. |

> ูู ูุฐู ุงููุฑุดุฉ ุณูุนูู ุนูู **Bulk RNA-seq** ูุฃููุง ุงูุฃูุณุจ ูุงูุชุดุงู ุงูุฌููุงุช ุงููุฎุชููุฉ ุจูู ุงูุญุงูุงุช.

---


## ููู ุชูุฎุฒูู ุจูุงูุงุช RNA-seqุ

ุนุงุฏุฉู ูุญุตู ุนูู ููููู ุฃุณุงุณููู:

1. **Count matrix:**  
   - ุงูุตููู = ุงูุฌููุงุช (Gene IDs)  
   - ุงูุฃุนูุฏุฉ = ุงูุนููุงุช (Samples)  
   - ุงูููู = ุนุฏุฏ ุงููุฑุงุกุงุช ููู ุฌูู ูู ูู ุนููุฉ  

2. **Metadata (ุฃู Design file):**  
   - ูุญุชูู ุนูู ูุนูููุงุช ูุตููุฉ ุนู ุงูุนููุงุช (ูุซู ููุน ุงูุนููุฉุ ุงูุญุงูุฉ ุงููุฑุถูุฉุ ูุตุฏุฑ ุงููุณูุฌ...)  
   - ูุฑุจุท ูู ุนููุฉ ุจุงุณููุง ุงูููุฌูุฏ ูู ุฌุฏูู ุงูุนุฏูุงุช  

> โจ ุจุฏูุฌ ุงูููููู ูููููุง ูุนุฑูุฉ ุฃู ูุฑุงุกุฉ ุชุฎุต ุฃู ุนููุฉ ูุฃู ุญุงูุฉ ูุฑุถูุฉ.

---

## ุงููุฏู ูู ุชุญููู ุงูุจูุงูุงุช

ูุฏููุง ูู ูุฐู ุงููุฑุดุฉ ูู ุชุญููู ุจูุงูุงุช RNA-seq ููุฌููุนุฉ ูู ุนููุงุช **ุณุฑุทุงู ุงูููููู**ุ  
ูุฏุฑุงุณุฉ ุงูุงุฎุชูุงู ูู ุงูุชุนุจูุฑ ุงูุฌููู ุจูู:

> **Primary tumor** vs **Solid tissue normal**

ูุณูููู ุจู:

1. ุชูุธูู ุงูุจูุงูุงุช ูุชุตููุฉ ุงูุฌููุงุช ููุฎูุถุฉ ุงูุชุนุจูุฑ.  
2. ุฅุฌุฑุงุก ุงูุชุญููู  ุจุงุณุชุฎุฏุงู **DESeq2**.  
3. ุฑุณู ุงููุฎุทุทุงุช ุงูุชูุณูุฑูุฉ (PCA, Volcano, Boxplot, Violin).  
4. Pathway Enrichment Analysis.   
5. ููู ุงูููุงูุฉุ ุณูุทุจู ุนููููุง ุนูู ููุงุฑูุฉ ุฃุฎุฑู.

---

## ุงูุฎุทูุงุช ุงูุนุงูุฉ ููุชุญููู

1. ูุฑุงุกุฉ ูููุงุช Counts ูุงูุจูุงูุงุช ุงููุตููุฉ.  
2. ุชุตููุฉ ุงูุฌููุงุช ููุฎูุถุฉ ุงูุชุนุจูุฑ.  
3. ุชุญููู ุงููุฑูู ุจูู ุงููุฌููุนุงุช (**DESeq2**).  
4. ุชุญููู ุงูุจูุงูุงุช (**VST**).  
5. ุฑุณู ุงูุนููุงุช ูุงูุฌููุงุช  (**PCA** ู**Volcano**).  
6. ุชุญููู ูููุธุงุฆู ุงููุชุฃุซุฑุฉ.

---

# 0. ุชููุฆุฉ ุจูุฆุฉ ุงูุนูู ูุชุญููู ุงูุญุฒู ุงูุจุฑูุฌูุฉ

> **ูุชุทูุจ ุณุงุจู ูููุฑุดุฉ:**  
> ูุฑุฌู ุงูุชุฃูุฏ ูู ุชุดุบูู ููู  
> `install_packages_bulkRNAseq.R`  
> ูุจู ุจุฏุก ุงููุฑุดุฉ ูุชุซุจูุช ุงูุญุฒู ุงููุงุฒูุฉ. <br>
> โ๏ธ ููุงุญุธุฉ: ูุฐู ุงูุฎุทูุฉ ูููุฉ ููุท ุฅุฐุง ูู ุชูู ุงูุญุฒู ูุซุจุชุฉ ูุณุจููุง ุนูู ุฌูุงุฒู.  
ุจุนุฏ ุงูุชุซุจูุช ููุฑุฉ ูุงุญุฏุฉุ ูููู ุชุฌุงูููุง ูุงูุงูุชูุงุก ุจุงุณุชุฎุฏุงู `library()` ูุงุญููุง.<br>
> ๐บ ููุดุงูุฏุฉ ุดุฑุญ ุชุซุจูุช ุงูุญุฒู ูู CRAN / GitHub / Bioconductor:  
> [ุทุฑููุฉ ุชุซุจูุช ุงูุญุฒู ูู R](https://youtu.be/AQpDAl2yfLM?si=iGebpOznDkZOIlBS)

---

## 0.1 ุงูุญุฒู ุงููุณุชุฎุฏูุฉ ููุฏู ูู ูููุง

**`library(tidyverse)`**  
> ุชูุญูููู ูุฌููุนุฉ ูู ุงูุญุฒู ุงููุชูุงููุฉ ูุซู `dplyr`, `ggplot2`, ู `readr`  
> ูุชุณููู ุงูุชุนุงูู ูุน ุงูุจูุงูุงุช ูุชูุธูููุง ูุชุญููููุง.  
> ๐ <https://www.tidyverse.org>

---

**`library(DESeq2)`**  
> ุงูุญุฒูุฉ ุงูุฃุณุงุณูุฉ ูุชุญููู ุจูุงูุงุช ุงูุชุนุจูุฑ ุงูุฌููู ุงูุชูุงุถูู (RNA-seq).  
> ุชุนุชูุฏ ุนูู ูููุฐุฌ **Negative Binomial** ูุชูุฏูู ุชุญููููุง ุฅุญุตุงุฆููุง ุฏููููุง.  
> ๐ <https://bioconductor.org/packages/release/bioc/html/DESeq2.html>

---

**`library(AnnotationDbi)` ู `library(org.Hs.eg.db)`**  
> ุชูุณุชุฎุฏูุงู ูุชุญููู ูุนุฑูุงุช ุงูุฌููุงุช (ูุซู Ensembl IDs)  
> ุฅูู ุฃุณูุงุก ุฌููุงุช ูุงุจูุฉ ูููุฑุงุกุฉ ุฃู ูุนุฑูุงุช Entrez  
> ๐ <https://bioconductor.org/packages/release/bioc/html/AnnotationDbi.html>

---

**`library(clusterProfiler)`**  
> ุญุฒูุฉ  ูุชุญููู   (Functional Enrichment)  
> ุณูุงุก ูู **GO** ุฃู **KEGG Pathways**.  
> ๐ <https://bioconductor.org/packages/release/bioc/html/clusterProfiler.html>

---

**`library(ggplot2)` ู `library(ggrepel)`**  
> ูุฅูุดุงุก ุฑุณูู ุจูุงููุฉ ุชูุงุนููุฉ ูุนูููุฉ ูุซู Volcano plot ู PCA ู Boxplot.  
> ๐ <https://ggplot2.tidyverse.org>

---

**`library(pheatmap)` ู `library(RColorBrewer)`**  
> ูุฅูุดุงุก ุฎุฑุงุฆุท ุญุฑุงุฑูุฉ (Heatmaps) ุบููุฉ ุจุงูุฃููุงู ูุชูุถูุญ ุฃููุงุท ุงูุชุนุจูุฑ ุงูุฌููู.  
> ๐ <https://cran.r-project.org/web/packages/pheatmap/>

---

**`library(ReactomePA)`**  
> ุญุฒูุฉ pathway analysis ุจุงุณุชุฎุฏุงู ูุงุนุฏุฉ ุจูุงูุงุช Reactome  
> ๐ <https://bioconductor.org/packages/release/bioc/html/ReactomePA.html>

---
## 0.2 ุชูุนูู ุงูุญุฒู

```{r error=FALSE, warning=FALSE, message=FALSE}
library(tidyverse)       
library(DESeq2)          
library(AnnotationDbi)   
library(org.Hs.eg.db)    
library(clusterProfiler) 
library(ggplot2)         
library(ggrepel)         
library(pheatmap)        
library(RColorBrewer)
library(ReactomePA)
```
# 1. ูุฑุงุกุฉ ุงูุจูุงูุงุช

## 1.1 ุชุญููู ูููุงุช **counts** ู **metadata**

ุงููููุงู ุงููุณุชุฎุฏูุงู ูุฃุฎูุฐุงู ูู ุชุฌุฑุจุฉ  **E-GEOD-50760**.


| ุงูููู | ุงููุญุชูู | ุงูุฑุงุจุท |
|--------|----------|---------|
| **counts** | ุนุฏุฏ ุงููุฑุงุกุงุช ููู ุฌูู ูู ูู ุนููุฉ | [ุฑุงุจุท ุงูุชุญููู](http://genomedata.org/gen-viz-workshop/intro_to_deseq2/tutorial/E-GEOD-50760-raw-counts.tsv) |
| **metadata** | ูุตู ุงูุนููุงุช ูุงูุญุงูุฉ ุงููุฑุถูุฉ | [ุฑุงุจุท ุงูุชุญููู](http://genomedata.org/gen-viz-workshop/intro_to_deseq2/tutorial/E-GEOD-50760-experiment-design.tsv) |

```{r}
#  ุชุญููู ุจูุงูุงุช ุงูู RNA-seq

#  ุชุญุฏูุฏ ุฑูุงุจุท ูููุงุช  (counts) ูููู ุงูุจูุงูุงุช ุงููุตููุฉ (metadata)
counts_url <- "http://genomedata.org/gen-viz-workshop/intro_to_deseq2/tutorial/E-GEOD-50760-raw-counts.tsv"
design_url <- "http://genomedata.org/gen-viz-workshop/intro_to_deseq2/tutorial/E-GEOD-50760-experiment-design.tsv"

# ุงูุฎุทูุฉ 2: ูุฑุงุกุฉ ุงููููุงุช ูู ุงูุฅูุชุฑูุช ูุจุงุดุฑุฉ ุจุงุณุชุฎุฏุงู ุฏุงูุฉ read_tsv ูู ููุชุจุฉ readr
# ุชููุฑุฃ ุงูุจูุงูุงุช ุฅูู ุฅุทุงุฑ ุจูุงูุงุช (Data Frame) ุฏุงุฎู R
counts <- readr::read_tsv(counts_url)    # ููู ุงูุนุฏูุงุช ุงูุฌูููุฉ
metadata <- readr::read_tsv(design_url)    # ููู ุงูุจูุงูุงุช ุงููุตููุฉ
```
## 1.2 ุงุณุชุนุฑุงุถ ุงูุจูุงูุงุช ูููู ููููุงุชูุง

### ูุง ุงูุฐู ูุญุชููู ูู ูููุ

ูุจู ุงูุจุฏุก ูู ุงูุชุญูููุ ูู ุงูููู ุฃู ูููู **ูุญุชูู ูู ููู** ููุง ุชูุซููู ุงูุฃุนูุฏุฉ ุจุฏุงุฎูู.


### ููู  (**counts**)

| ุงูุนููุฏ | ุงูุดุฑุญ |
|--------|--------|
| **gene_id** | ูุนุฑู ุงูุฌูู (ุนุงุฏุฉู ูููู ุจุตูุบุฉ Ensembl ID ูุซู: ENSG00000141510). |
| **ุจููุฉ ุงูุฃุนูุฏุฉ** | ุฃุณูุงุก ุงูุนููุงุชุ ุจุญูุซ ููุซู ูู ุนููุฏ ุนููุฉ ูุงุญุฏุฉ ุชุญุชูู ุนูู ุนุฏุฏ ุงููุฑุงุกุงุช ุงูุฎุงุตุฉ ุจูุง. |


### ููู ุงูุจูุงูุงุช ุงููุตููุฉ (**metadata**)

| ุงูุนููุฏ | ุงูุดุฑุญ |
|--------|--------|
| **Run** | ุงุณู ุฃู ุฑูุฒ ุงูุนููุฉ (ูุชูุงูู ูุน ุฃุณูุงุก ุงูุฃุนูุฏุฉ ูู ููู counts). |
| **Sample Characteristic[disease]** | ูุตู ููุน ุงููุฑุถ ุงููุฑุชุจุท ุจุงูุนููุฉ (ูุซู: Colorectal Cancer). |
| **Sample Characteristic[biopsy site]** | ูููุน ุฃุฎุฐ ุงูุนููุฉ (ูุซู: Primary tumor ุฃู Solid tissue normal). |
| **Sample Characteristic[disease staging]** | ูุฑุญูุฉ ุงููุฑุถ ุฃู ุฏุฑุฌุฉ ุงููุฑู (ูุซู: Stage IV). |
| **Sample Characteristic[organism]** | ููุน ุงููุงุฆู ุงูุญู (ุนุงุฏุฉู Homo sapiens). |
| **Factor Value[biopsy site]** | ุงููุชุบูุฑ ุงูุชุฌุฑูุจู ุงูุฑุฆูุณู ุงูุฐู ุณูุณุชุฎุฏูู ูุงุญููุง ููููุงุฑูุฉ ุจูู ุงููุฌููุนุงุช. |


### ุงุณุชุนุฑุงุถ ุงูุจูุงูุงุช ูู R

ุงูุขู ุณูุณุชุนุฑุถ ุดูู ุงููููุงุช ุจุนุฏ ูุฑุงุกุชูุง ุฏุงุฎู R ููุชุฃูุฏ ูู ุฃู ุงูุจูุงูุงุช ููุฑุฆุช ุจุดูู ุตุญูุญุ  
ููููู ุฃุณูุงุก ุงูุฃุนูุฏุฉ ูุนุฏุฏ ุงูุนููุงุช ูู ูู ููู.

```{r}
#  ุงุณุชุนุฑุงุถ ุดูู ุจูุงูุงุช (counts)
head(counts)

#  ุงุณุชุนุฑุงุถ ุดูู ุจูุงูุงุช ุงูููู ุงููุตูู (metadata)
head(metadata)
```
## 1.3 ุชุฌููุฒ ูููุงุช metadata ู counts ูุชุณููู ุงูุชุนุงูู

ุจุนุฏ ุชุญููู ุงููููุงุชุ ูุญุชุงุฌ ูุชุจุณูุทูุง ูุชุฌููุฒูุง ุญุชู ุชููู ุฌุงูุฒุฉ ููุชุญููู ุจุงุณุชุฎุฏุงู DESeq2.


### ุงูุฎุทูุฉ 1: ุชุฌููุฒ ููู metadata

ููู `metadata` ูุญุชูู ุนูู ุงูุนุฏูุฏ ูู ุงูุฃุนูุฏุฉ ุบูุฑ ุงูุถุฑูุฑูุฉ.  
ุณูููู ุจุงุฎุชูุงุฑ ุงูุฃุนูุฏุฉ ุงููููุฉ ููุทุ ูุฅุนุงุฏุฉ ุชุณููุชูุงุ ูุชุจุณูุท ุงูููู ูุชุตุจุญ ูุฎุชุตุฑุฉ ูุณููุฉ ุงูุงุณุชุฎุฏุงู.

```{r}
metadata <- metadata %>%
  column_to_rownames(var = "Run") %>%                      # ุฌุนู ุงูุนููุฏ "Run" ูู ุฃุณูุงุก ุงูุตููู 
  select(`Sample Characteristic[biopsy site]`, 
         `Sample Characteristic[individual]`)              # ุงุฎุชูุงุฑ ุนููุฏูู ูุญุฐู ุงูุจููุฉ

colnames(metadata) <- c("tissueType", "individualID")      # ุชุบููุฑ ุฃุณูุงุก ุงูุฃุนูุฏุฉ ูุชุตุจุญ ุฃูุถุญ

metadata$tissueType <- metadata$tissueType %>%
  str_replace("colorectal cancer metastatic in the liver", "liver_meta") %>%  # ุชุบููุฑ ุงูุงุณู ุฅูู liver_meta
  str_replace("primary tumor", "primary_tumor") %>%                           # ุชุบููุฑ ุงูุงุณู ุฅูู primary_tumor
  str_replace("solid tissue normal", "normal") %>%                            # ุชุบููุฑ ุงูุงุณู ุฅูู normal
  as.factor()                                                                # ุชุญููู ุงูุนููุฏ ุฅูู ุนุงูู (factor) ูุงููุง ูุฆุงุช.

head(metadata)                                                                # ุนุฑุถ ุฃูู 6 ุตููู ูู ุงูุฌุฏูู ุงููุนุฏู
```
### ๐ก ููุงุฐุง ูุฐู ุงูุฎุทูุฉ ูููุฉุ

- ุชุจุณูุท ุงูุฃุณูุงุก ูุฌุนู ุงูููุงุฑูุฉ ุฃุณูู (ุฎุงุตุฉ ูู `contrast` ุฏุงุฎู **DESeq2**).  
- ุฅุฒุงูุฉ ุงููุณุงูุงุช ุชููุน ุงูุฃุฎุทุงุก ุนูุฏ ูุชุงุจุฉ ุฃุณูุงุก ุงูุญุงูุงุช ุฏุงุฎู ุงูุฃูุงูุฑ.  
- ุชุณููุฉ ุงูุฃุนูุฏุฉ ุจุดูู ูุงุถุญ (`tissueType`, `individualID`) ุชุณุงุนุฏ ูู ุงูููู ูุงููุฑุงุกุฉ.


### ุงูุฎุทูุฉ 2: ุชุฌููุฒ ููู (counts)

ููู Counts ูุญุชูู ุนูู ุฃุณูุงุก ุงูุฌููุงุช ูู ุนููุฏูู:  
**"Gene ID"** ู **"Gene Name"**  
ูุชุญุชุงุฌ ููุชุจุฉ **DESeq2** ุฅูู ุฃู ุชููู **ุฃุณูุงุก ุงูุฌููุงุช ูู ุฃุณูุงุก ุงูุตููู (rownames)**ุ  
ูุฐูู ุณูุนูุฏ ููููุฉ ุงูููู ุจูุฐุง ุงูุดูู.

```{r}
# ุชุญุฏูุฏ ุงุณู ุนููุฏ ูุนุฑู ุงูุฌูู (ุนุงุฏุฉ ูููู ุงูุนููุฏ ุงูุฃูู)
gene_col <- colnames(counts)[1]

# ุงุณุชุฎุฑุงุฌ ุฃุณูุงุก ุงูุฌููุงุช ูู ุงูุนููุฏ ุงูุฃูู
gene_ids <- counts[[gene_col]]

# ุงุณุชุฎุฑุงุฌ ุฃุณูุงุก ุงูุฌููุงุช ุงูููุงุจูุฉ ูู ุงูุนููุฏ "Gene Name"
gene_names <- counts[["Gene Name"]]                                # ุฃุฎุฐ ุฃุณูุงุก ุงูุฌููุงุช (ูุซู TP53ุ MYCุ ...)

# ุฅุฒุงูุฉ ุงูุนููุฏูู "Gene ID" ู"Gene Name" ูู ุงูุจูุงูุงุช
count_data <- counts[, !(colnames(counts) %in% c(gene_col, "Gene Name"))]

# ุชุญููู ุงูููู ุฅูู ุฃุฑูุงู ุจุนุฏ ุฅุฒุงูุฉ ุงููุณุงูุงุช ุงูุจูุถุงุก
count_data[] <- lapply(count_data, function(x) as.numeric(str_trim(x)))

# ุชุญููู ุงูุฅุทุงุฑ ุฅูู ูุตูููุฉ ุฑูููุฉ
count_mat <- as.matrix(count_data)

# ุชุนููู ุฃุณูุงุก ุงูุฌููุงุช ูุฃุณูุงุก ุตููู
rownames(count_mat) <- gene_ids

# ุงูุชุญูู ูู ุดูู ุงูุจูุงูุงุช ุจุนุฏ ุงูุชุญููู
head(count_mat[, 1:5])                                         
```

## 1.4 ูุทุงุจูุฉ ุงูุนููุงุช ุจูู ูููุงุช **counts** ู **metadata**

ุจุนุฏ ุฃู ุงุณุชุนุฑุถูุง ุดูู ุงูุจูุงูุงุชุ  
ููุชูู ุงูุขู ุฅูู ุฎุทูุฉ ูููุฉ ุฌุฏูุง ููู **ูุทุงุจูุฉ ุงูุนููุงุช ุจูู ุงูููููู**.


### ุงููุฏู ูู ูุฐู ุงูุฎุทูุฉ

ูุญุชุงุฌ ุฅูู ุงูุชุฃูุฏ ูู ุฃู ุฃุณูุงุก ุงูุนููุงุช ูู **metadata** ุชุทุงุจู ุชูุงููุง ุฃุณูุงุก ุงูุฃุนูุฏุฉ ูู ููู **counts**ุ  
ูุฃู ุฃู ุงุฎุชูุงู ุฃู ุชุฑุชูุจ ุบูุฑ ูุชูุงุณู ุณูุคุฏู ุฅูู **ุชุญููู ุฎุงุทุฆ** ูู ุงูุฎุทูุงุช ุงููุงุญูุฉ.  

> ๐ก ุงูููุฑุฉ:  
> ูู ุตู ูู `metadata` ูุฌุจ ุฃู ููุงุจู ุนููุฏูุง ูู `counts` ููุซู ููุณ ุงูุนููุฉ.


###  ุงูุฎุทูุงุช 

```{r}
rownames(metadata) <- str_trim(rownames(metadata))                 # ุฅุฒุงูุฉ ุฃู ูุณุงูุงุช ุฒุงุฆุฏุฉ ูู ุฃุณูุงุก ุงูุตููู ูู ุฌุฏูู metadata
colnames(count_mat) <- str_trim(colnames(count_mat))               # ุฅุฒุงูุฉ ุฃู ูุณุงูุงุช ุฒุงุฆุฏุฉ ูู ุฃุณูุงุก ุงูุฃุนูุฏุฉ ูู ูุตูููุฉ count_mat

metadata <- metadata[match(colnames(count_mat), rownames(metadata)), ]  # ุฅุนุงุฏุฉ ุชุฑุชูุจ ุตููู metadata ุจุญูุซ ุชุชุทุงุจู ูุน ุชุฑุชูุจ ุฃุนูุฏุฉ count_mat

all(rownames(metadata) == colnames(count_mat))                     # ุงูุชุญูู ูู ุฃู ุฃุณูุงุก ุงูุตููู ูู metadata ูุทุงุจูุฉ ุชูุงููุง ูุฃุณูุงุก ุงูุฃุนูุฏุฉ ูู count_mat
```

### ูุง ุฃูููุฉ ูุฐุง ุงูุชุฑุชูุจุ

ูุฃู ุฎูุงุฑุฒููุฉ **DESeq2** ุชูุชุฑุถ ุฃู **ุงูุชุฑุชูุจ ูู ููู metadata ูุทุงุจู ุชูุงููุง ุชุฑุชูุจ ุงูุฃุนูุฏุฉ ูู ููู ุงูุนุฏูุงุช (counts)**.  
ุฃู ุงุฎุชูุงู ูู ุงูุชุฑุชูุจ ุณูุคุฏู ุฅูู ุฑุจุท ุบูุฑ ุตุญูุญ ุจูู ุงููุฑุงุกุงุช ูุงูุนููุงุชุ  
ููุง ูุณุจุจ **ุชุญููููุง ุฅุญุตุงุฆููุง ุฎุงุทุฆูุง** ููุชุงุฆุฌ ุบูุฑ ููุซููุฉ.


### โจ ููุฎุต ุงููุฑุญูุฉ ุงูุณุงุจูุฉ

โ ูุฑุฃูุง ุงูุจูุงูุงุช ุจูุฌุงุญ.  
โ ููููุง ููููุงุช ูู ููู.  
โ ุฑุจุทูุง ุงูุนููุงุช ูุชุฃูุฏูุง ูู ุชุฑุชูุจูุง ุงูุตุญูุญ.

> ุฃุตุจุญูุง ุงูุขู ุฌุงูุฒูู ููุจุฏุก ูู ุงูุชุญููู ุงูุฅุญุตุงุฆู ุจุงุณุชุฎุฏุงู **DESeq2**.


# 2. ุชุตููุฉ ุงูุฌููุงุช ููุฎูุถุฉ ุงูุชุนุจูุฑ

### ๐ก ุงููุฏู ูู ูุฐู ุงูุฎุทูุฉ

ูู ุจูุงูุงุช **RNA-seq**ุ ุชูุฌุฏ ุฌููุงุช ุฐุงุช ูุณุชููุงุช ุชุนุจูุฑ ููุฎูุถุฉ ุฌุฏูุง  
(ูุฏ ุชููู ูุงุชุฌุฉ ุนู ุถุฌูุฌ ุฃู ูุฑุงุกุฉ ุนุดูุงุฆูุฉ).  
ูุฐู ุงูุฌููุงุช ูุง ุชุถูู ูุนูููุงุช ูููุฏุฉ ูุบุงูุจูุง ูุง ุชูุถุนู ุฏูุฉ ุงูุชุญููู ุงูุฅุญุตุงุฆู.  

ูุฐูู ูููู ุจุชุตููุฉ ุงูุฌููุงุช ุฐุงุช ุงููุฑุงุกุงุช ุงูููุฎูุถุฉ ูุจู ุงุณุชุฎุฏุงู  **DESeq2**.


### ููู ููุฑุฑ ุฃู ุงูุฌููุงุช ูุญุฐูุ

ูุญุณุจ ูุฌููุน ุงููุฑุงุกุงุช ููู ุฌูู ุนุจุฑ ุฌููุน ุงูุนููุงุชุ  
ุซู ูุญุฐู ุงูุฌููุงุช ุงูุชู ูููู ูุฌููุนูุง ุฃูู ูู ูููุฉ ูุนููุฉ (ูุซู **10** ุฃู **20**).  
ุงููููุฉ ููุณุช ุซุงุจุชุฉุ ูููู ุงููุฏู ูู ุงูุงุญุชูุงุธ ููุท ุจุงูุฌููุงุช ุฐุงุช ุงูุฅุดุงุฑุฉ ุงูุญููููุฉ.


## 2.1 ุญุณุงุจ ูุฌููุน ุงููุฑุงุกุงุช ูุชุตููุฉ ุงูุฌููุงุช

```{r}
# ุญุณุงุจ ูุฌููุน ุงููุฑุงุกุงุช ููู ุฌูู ุนุจุฑ ุฌููุน ุงูุนููุงุช
gene_sums <- rowSums(count_mat, na.rm = TRUE)

# ุงูุงุญุชูุงุธ ููุท ุจุงูุฌููุงุช ุงูุชู ูุฌููุน ูุฑุงุกุงุชูุง โฅ 10
keep <- gene_sums >= 10
count_mat <- count_mat[keep, ]

#ูุฑุคูุฉ ุชุฃุซูุฑ ุงูุชุตููุฉ ูุนุฏุฏ ุงูุฌููุงุช ูุจู ูุจุนุฏ ุงูุนูููุฉ
cat("ุนุฏุฏ ุงูุฌููุงุช ูุจู ุงูุชุตููุฉ:", length(gene_sums), "\n")
cat("ุนุฏุฏ ุงูุฌููุงุช ุจุนุฏ ุงูุชุตููุฉ:", sum(keep), "\n")
```

## 3. ุฅูุดุงุก ูุงุฆู ุงูุชุญููู ุงูุฑุฆูุณู ุจุงุณุชุฎุฏุงู DESeq2

### ๐ก ูุง ุงููุฏู ูู ูุฐู ุงูุฎุทูุฉุ

ุจุนุฏ ุฃู ุฃุตุจุญุช ุจูุงูุงุช counts  ุฌุงูุฒุฉ ููุตูููุฉ ุจุดูู ุตุญูุญุ  
ูุญุชุงุฌ ุงูุขู ุฅูู ุฅูุดุงุก ูุงุฆู ุชุญูููู ูู ููุชุจุฉ **DESeq2** ูุฌูุน ุจูู:

- ุจูุงูุงุช ุงูุนุฏูุงุช (**count_mat**)  
- ุงูุจูุงูุงุช ุงููุตููุฉ (**metadata**)  
- ุงููุนุงุฏูุฉ ุงูุชุฌุฑูุจูุฉ ุงูุชู ุชุญุฏุฏ ุงูููุงุฑูุฉ (**design formula**)  

ูุฐุง ุงููุงุฆู ููุนุฏ ุงูุฎุทูุฉ ุงูุฃุณุงุณูุฉ ุงูุชู ุณุชูุณุชุฎุฏู ูุงุญููุง ูู ุฌููุน ูุฑุงุญู ุงูุชุญููู.


### ุฅูุดุงุก ูุงุฆู DESeq2

```{r}
dds <- DESeqDataSetFromMatrix(
  countData = count_mat,   # ูุตูููุฉ ุงูุนุฏูุงุช ุจุนุฏ ุงูุชุตููุฉ ูุงูุชุญููู
  colData   = metadata,    # ููู ุงูุจูุงูุงุช ุงููุตููุฉ ุจุนุฏ ุงูุชูุธูู
  design    = ~ tissueType # ุงูุนููุฏ ุงูุฐู ูุฑูุฏ ุงูููุงุฑูุฉ ุจูุงุกู ุนููู
)
```
# 4. ุชุดุบูู ุงูุชุญููู ุจุงุณุชุฎุฏุงู DESeq2

###  ููููุงุช  `dds`

ุจุนุฏ ุฅูุดุงุฆูุ ูุญุชูู ุงููุงุฆู `dds` ุนูู ุซูุงุซุฉ ููููุงุช ุฑุฆูุณูุฉ:

| ุงูููููู | ุงูุดุฑุญ |
|----------|--------|
| **countData** | ูุตูููุฉ ุงูุนุฏูุงุช ุงูุฌูููุฉ ุจุนุฏ ุงูุชุตููุฉ (ุนุฏุฏ ุงููุฑุงุกุงุช ููู ุฌูู ูู ูู ุนููุฉ). |
| **colData** | ุฌุฏูู ุงูุจูุงูุงุช ุงููุตููุฉ (metadata) ููู ุนููุฉุ ูุชุถูู ููุน ุงูุนููุฉ ุฃู ุงูุญุงูุฉ ุงููุฑุถูุฉ. |
| **design** | ุงููุนุงุฏูุฉ ุงูุชุฌุฑูุจูุฉ ุงูุชู ุชูุฎุจุฑ DESeq2 ููู ููุงุฑู ุงููุฌููุนุงุช (ููุง: ~ `tissueType`). |

> ๐ก ูุฐุง ูุนูู ุฃู ุฎูุงุฑุฒููุฉ **DESeq2** ุณุชุจุญุซ ุนู ุงูุฌููุงุช ุงูุชู ูุฎุชูู ูุณุชูู ุชุนุจูุฑูุง ุจุงุฎุชูุงู ููุน ุงููุณูุฌ  
> (ูุซู: *Primary tumor* ููุงุจู *Solid tissue normal*).


### ุฎูู ุงูููุงููุณ: ููู ูุนูู DESeq2 ุฅุญุตุงุฆููุงุ

ููู ุฌูู ุนูู ุญุฏุฉุ ูููู **DESeq2** ุจุชูููุฐ ุณูุณูุฉ ูู ุงูุฎุทูุงุช ุงูุฑูุงุถูุฉ ูุงูุฅุญุตุงุฆูุฉ ุงูุฏูููุฉ:

1. **ุงููููุฐุฌ ุงูุฅุญุตุงุฆู ุงููุณุชุฎุฏู:**  
   ูู ุฌูู ููุญููู ุจุงุณุชุฎุฏุงู ูููุฐุฌ ูู ููุน **Negative Binomial**ุ  
   ููู ูุซุงูู ููุชุนุงูู ูุน ุจูุงูุงุช ุงูุนุฏูุงุช ุงูุชู ูุง ุชุชุจุน ุงูุชูุฒูุน ุงูุทุจูุนู.

2. **ุชูุฏูุฑ ุนุงูู ุงูุญุฌู (Size Factor):**  
   ููุญุณุจ ุนุงูู ููู ุนููุฉ ูุชุตุญูุญ ุงููุฑููุงุช ูู ุนูู ุงููุฑุงุกุฉ (**Library size**).  
   ููุซูุงูุ ุฅุฐุง ูุงูุช ุนููุฉ ุชูุชูู ุถุนู ุนุฏุฏ ุงููุฑุงุกุงุช ููุงุฑูุฉ ุจุฃุฎุฑูุ  
   ูุชู ุชุนุฏูู ุฐูู ูุจู ุงูููุงุฑูุฉ ุญุชู ูุง ููุญุณุจ ูุชุนุจูุฑ ุฌููู ูุนูู.

3. **ุชูุฏูุฑ ุงูุชุดุชุช (Dispersion):**  
   ููุฏูุฑ ุงูุจุฑูุงูุฌ ูุฏู ุชุจุงูู ุงูุนุฏูุงุช ุฏุงุฎู ูู ูุฌููุนุฉ (ูุซูุงูุ ุจูู ุงูุนููุงุช ุงููุฑููุฉ).  
   ูุฐุง ุงูุชุดุชุช ููุณุชุฎุฏู ูุชุญุฏูุฏ ูุฏู ุซูุฉ ุงููููุฐุฌ ุจุงููุฑู ุงููุฑุตูุฏ.

4. **ุงูุงุฎุชุจุงุฑ ุงูุฅุญุตุงุฆู (Wald Test):**  
    ูุชู ุชุทุจูู ุงุฎุชุจุงุฑ **Wald** ููู ุฌูู ูุงุฎุชุจุงุฑ ุงููุฑุถูุฉ ุงูุตูุฑูุฉ:  
   > Hโ: ูุง ููุฌุฏ ูุฑู ูู ุงูุชุนุจูุฑ ุจูู ุงููุฌููุนุชูู.

5. **ุชุตุญูุญ ููู  (p-value):**  
   ูุชู ุชุตุญูุญ ุงูููู ุจุงุณุชุฎุฏุงู ุทุฑููุฉ **FDR (BenjaminiโHochberg)**  
   ูุฅูุชุงุฌ ุงูุนููุฏ **padj** ุงูุฐู ููุซู ุงูุฏูุงูุฉ ุงูุฅุญุตุงุฆูุฉ ุงููุตุญุญุฉ.


### โจ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ ูู ุงูุชุญููู

ููู ุฌููุ ูุญุตู ุนูู ูุฌููุนุฉ ูู ุงูููู ุงูุฃุณุงุณูุฉ:

| ุงูุนููุฏ | ุงูุดุฑุญ ุงููุจุณูุท | ููุงุฐุง ูู ูููุ |
|--------|----------------|----------------|
| **baseMean** | ุงููุชูุณุท ุงูุนุงู ูุนุฏุฏ ุงููุฑุงุกุงุช (counts) ููู ุฌูู ุจุนุฏ **normalization** ุนุจุฑ ุฌููุน ุงูุนููุงุช. | ูุณุงุนุฏ ุนูู ูุนุฑูุฉ ูุฏู ุงูุชุนุจูุฑ ุงูุนุงู ููุฌูู ูู ุงูุชุฌุฑุจุฉุ ููููุฒ ุงูุฌููุงุช ุฐุงุช ุงูุชุนุจูุฑ ุงูููุฎูุถ ุฌุฏุงู ุงูุชู ูุฏ ุชููู ุบูุฑ ููุซููุฉ. |
| **log2FoldChange** | ููุฏุงุฑ ุงููุฑู ูู ุงูุชุนุจูุฑ ุจูู ุงููุฌููุนุชูู ุนูู ูููุงุณ ููุบุงุฑูุชูู ุจุงูุฃุณุงุณ 2 (ูุนูู +1 = ุฒูุงุฏุฉ ุจููุฏุงุฑ ุงูุถุนูุ โ1 = ุงูุฎูุงุถ ูููุตู). | ููุถุญ ุญุฌู ูุงุชุฌุงู ุงูุชุบูุฑ ูู ุงูุชุนุจูุฑุ ููู ุงููุคุดุฑ ุงูุฃุณุงุณู ููุฌููุงุช ุงููุชุบูุฑุฉ ูุนููุงู ุจูู ุงููุฌููุนุชูู. |
| **lfcSE** | ููุฏุงุฑ ุนุฏู ุงููููู (ุงูุฎุทุฃ ุงููุนูุงุฑู) ูู ุชูุฏูุฑ ูููุฉ **log2FoldChange**. | ููุณุชุฎุฏู ูุชูููู ูุฏู ุฏูุฉ ุงูุชูุฏูุฑุ ูููุง ูุงู ุฃุตุบุฑ ุฒุงุฏุช ุงูุซูุฉ ูู **log2FoldChange**. |
| **stat** | ุงููููุฉ ุงููุงุชุฌุฉ ูู ุงุฎุชุจุงุฑ Waldุ ูุชูุณุชุฎุฏู ูุชุญุฏูุฏ ูุฏู ููุฉ ุงููุฑู ุจูู ุงููุฌููุนุชูู. | ุชุนูุณ ูุฏู ุฏุนู ุงูุจูุงูุงุช ููุฌูุฏ ูุฑู ุญูููู ูู ุงูุชุนุจูุฑุ ููู ุฃูุจุฑ ุชุนูู ูุฑูุงู ุฃูุถุญ. |
| **pvalue** | ุงุญุชูุงู ุฃู ูููู ุงููุฑู ุงูููุงุญุธ ุญุฏุซ ุจุงูุตุฏูุฉ (ูุจู ุงูุชุตุญูุญ ุงูุฅุญุตุงุฆู). | ุชุณุงุนุฏ ุนูู ุงูุชูููุฒ ุงููุจุฏุฆู ุจูู ุงูุฌููุงุช ุงููููุฉ ูุบูุฑ ุงููููุฉ ุฅุญุตุงุฆูุงู. |
| **padj** | ููุณ ุงููููุฉ ุงูุณุงุจูุฉ ูููู ุจุนุฏ ุงูุชุตุญูุญ ูุงุฎุชุจุงุฑุงุช ูุชุนุฏุฏุฉ (**FDR**). | ุชููู ูู ุงุญุชูุงููุฉ ุงูุชุดุงู ูุชุงุฆุฌ ูุงุฐุจุฉ (false positives) ุนูุฏ ุงุฎุชุจุงุฑ ุขูุงู ุงูุฌููุงุช ูู ููุช ูุงุญุฏ. |


### ุชุดุบูู ุงูุชุญููู 

ุงูุขู ูุดุบูู ุฎูุงุฑุฒููุฉ ุงูุชุญููู ุนูู ูุงุฆู `dds`.  
ุณุชููู ูุฐู ุงูุฏุงูุฉ ุชููุงุฆููุง ุจุชูููุฐ ุฌููุน ุงููุฑุงุญู ุงูุณุงุจูุฉ:

```{r}
dds <- DESeq(dds)
```

### ูุฑุงุกุฉ ุงููุชุงุฆุฌ:

ุจุนุฏ ุชูููุฐ ูุฐุง ุงูุณุทุฑุ ุฃุตุจุญ ูุฏููุง ูููุฐุฌ ูุงูู ุฌุงูุฒ ูุงุณุชุฎุฑุงุฌ ุงููุชุงุฆุฌ.
ููููู ูุฑุงุกุฉ ุงููุงุฆู dds ูุฑุคูุฉ ูุนูููุงุช ุนู ุนุฏุฏ ุงูุฌููุงุช ูุงูุนููุงุช ูุงูุฎุตุงุฆุต:
```{r}
dds
```

# 5. ุงุณุชุฎุฑุงุฌ ูุชุงุฆุฌ ุงูููุงุฑูุฉ

### ๐ก ุงููุฏู ูู ูุฐู ุงูุฎุทูุฉ

ุจุนุฏ ุฃู ุดุบูููุง ูููุฐุฌ **DESeq2** ุนูู ุงูุจูุงูุงุชุ  
ุญุงู ุงูููุช ูุงุณุชุฎุฑุงุฌ ุงููุชุงุฆุฌ ุงูุฎุงุตุฉ ุจุงูููุงุฑูุฉ ุงูุชู ููุชู ุจูุง.

ูู ูุฐู ุงููุฑุดุฉุ ูุฑูุฏ ููุงุฑูุฉ ุงูุชุนุจูุฑ ุงูุฌููู ุจูู:

> **Primary tumor vs Solid tissue normal**


### ุงุณุชุฎุฑุงุฌ ุงููุชุงุฆุฌ

```{r}
res <- results(
  dds,
  contrast = c("tissueType", "primary_tumor", "normal")
)
```

### ๐ก ูุง ูุนูู ุงูู contrastุ

ุงููููุฉ ุงูุฃููู `"tissueType"` ูู ุงุณู ุงูุนููุฏ ุงูุฐู ููุงุฑู ุจูุงุกู ุนููู.  
ุซู ูุญุฏุฏ ุงููุฌููุนุชูู ููููุงุฑูุฉ:

- `"primary_tumor"` โ ุงููุฌููุนุฉ ุงูุชุฌุฑูุจูุฉ.  
- `"normal"` โ ุงููุฌููุนุฉ ุงููุฑุฌุนูุฉ (baseline).  


### ุชูุณูุฑ ุงูุฃุนูุฏุฉ ูู ูุงุชุฌ DESeq2

| ุงูุนููุฏ | ุงูุดุฑุญ ุงููุจุณูุท | ููุงุฐุง ูู ูููุ |
|--------|----------------|----------------|
| **baseMean** | ุงููุชูุณุท ุงูุนุงู ูุนุฏุฏ ุงููุฑุงุกุงุช (counts) ููู ุฌูู ุจุนุฏ **normalization** ุนุจุฑ ุฌููุน ุงูุนููุงุช. | ูุณุงุนุฏ ุนูู ูุนุฑูุฉ ูุฏู ุงูุชุนุจูุฑ ุงูุนุงู ููุฌูู ูู ุงูุชุฌุฑุจุฉุ ููููุฒ ุงูุฌููุงุช ุฐุงุช ุงูุชุนุจูุฑ ุงูููุฎูุถ ุฌุฏุงู ุงูุชู ูุฏ ุชููู ุบูุฑ ููุซููุฉ. |
| **log2FoldChange** | ููุฏุงุฑ ุงููุฑู ูู ุงูุชุนุจูุฑ ุจูู ุงููุฌููุนุชูู ุนูู ูููุงุณ ููุบุงุฑูุชูู ุจุงูุฃุณุงุณ 2 (ูุนูู +1 = ุฒูุงุฏุฉ ุจููุฏุงุฑ ุงูุถุนูุ โ1 = ุงูุฎูุงุถ ูููุตู). | ููุถุญ ุญุฌู ูุงุชุฌุงู ุงูุชุบูุฑ ูู ุงูุชุนุจูุฑุ ููู ุงููุคุดุฑ ุงูุฃุณุงุณู ููุฌููุงุช ุงููุชุบูุฑุฉ ูุนููุงู ุจูู ุงููุฌููุนุชูู. |
| **lfcSE** | ููุฏุงุฑ ุนุฏู ุงููููู (ุงูุฎุทุฃ ุงููุนูุงุฑู) ูู ุชูุฏูุฑ ูููุฉ **log2FoldChange**. | ููุณุชุฎุฏู ูุชูููู ูุฏู ุฏูุฉ ุงูุชูุฏูุฑุ ูููุง ูุงู ุฃุตุบุฑ ุฒุงุฏุช ุงูุซูุฉ ูู **log2FoldChange**. |
| **stat** | ุงููููุฉ ุงููุงุชุฌุฉ ูู ุงุฎุชุจุงุฑ Waldุ ูุชูุณุชุฎุฏู ูุชุญุฏูุฏ ูุฏู ููุฉ ุงููุฑู ุจูู ุงููุฌููุนุชูู. | ุชุนูุณ ูุฏู ุฏุนู ุงูุจูุงูุงุช ููุฌูุฏ ูุฑู ุญูููู ูู ุงูุชุนุจูุฑุ ููู ุฃูุจุฑ ุชุนูู ูุฑูุงู ุฃูุถุญ. |
| **pvalue** | ุงุญุชูุงู ุฃู ูููู ุงููุฑู ุงูููุงุญุธ ุญุฏุซ ุจุงูุตุฏูุฉ (ูุจู ุงูุชุตุญูุญ ุงูุฅุญุตุงุฆู). | ุชุณุงุนุฏ ุนูู ุงูุชูููุฒ ุงููุจุฏุฆู ุจูู ุงูุฌููุงุช ุงููููุฉ ูุบูุฑ ุงููููุฉ ุฅุญุตุงุฆูุงู. |
| **padj** | ููุณ ุงููููุฉ ุงูุณุงุจูุฉ ูููู ุจุนุฏ ุงูุชุตุญูุญ ูุงุฎุชุจุงุฑุงุช ูุชุนุฏุฏุฉ (**FDR**). | ุชููู ูู ุงุญุชูุงููุฉ ุงูุชุดุงู ูุชุงุฆุฌ ูุงุฐุจุฉ (false positives) ุนูุฏ ุงุฎุชุจุงุฑ ุขูุงู ุงูุฌููุงุช ูู ููุช ูุงุญุฏ. |


### ูุฑุงุกุฉ ุงููุชุงุฆุฌ

```{r}
head(res)
```

ูููููุง ุชุฑุชูุจ ุงููุชุงุฆุฌ ูุงุญููุง ุญุณุจ ุงูุฃูููุฉ ุงูุฅุญุตุงุฆูุฉุ  
ุญูุซ ุชูุซู ุงูููู ุงูุฃูู ูู **padj** ุงูุฌููุงุช ุงูุฃูุซุฑ ุฏูุงูุฉ ูู ุงููุฑูู.


## ๐ ููุฎุต ูุฐู ุงููุฑุญูุฉ

โจ ูู ูุฐู ุงููุฑุญูุฉ ูููุง ุจู:

- ุชุตููุฉ ุงูุฌููุงุช ููุฎูุถุฉ ุงูุชุนุจูุฑ ูุชูููู ุงูุถุฌูุฌ.  
- ุฅูุดุงุก ูุงุฆู ุงูุชุญููู ูุชุฌููุฒู ุจุงุณุชุฎุฏุงู **DESeq2**.  
- ุชุดุบูู ุงูุชุญููู ุงูุฅุญุตุงุฆู ุงููุงูู.  
- ุงุณุชุฎุฑุงุฌ ูุชุงุฆุฌ ุงูููุงุฑูุฉ ุจูู ุงููุฑู ุงูุฃููู ูุงููุณูุฌ ุงูุทุจูุนู.  
- ููู ุฃุนูุฏุฉ ุงููุชุงุฆุฌ ูููููุฉ ุชูุณูุฑูุง.  

> ๐ก ุงููุชูุฌุฉ: ุฃุตุจุญ ูุฏููุง ุฌุฏูู ููุงุฆู ููุฌููุงุช ูุน ููู ุฏูููุฉ ูููุฑูู ูู ุงูุชุนุจูุฑ ุงูุฌูููุ  
> ูุณูุจุฏุฃ ุงูุขู ูู ุชุญููู ุงูุจูุงูุงุช ุจุตุฑููุง ุจุงุณุชุฎุฏุงู PCA ูVolcano ูBoxplot ูViolin.


# 6. ุชุญููู ุงูุจูุงูุงุช  (VST Transformation)

### ๐ก ุงููุฏู ูู ูุฐู ุงูุฎุทูุฉ

ูู ุจูุงูุงุช ุงูู RNA-seq ุงูุฎุงู (ุงูุนุฏูุงุช **counts**)  
ูุฒุฏุงุฏ ุงูุชุจุงูู ูุน ุฒูุงุฏุฉ ุงููุชูุณุทุ  
ููุง ูุฌุนู ุงูุฑุณูู ูุซู **PCA** ุฃู **Heatmap** ุบูุฑ ุฏูููุฉ โ  
ุญูุซ ุชูููู ุงูุฌููุงุช ุฐุงุช ุงููุฑุงุกุงุช ุงูุนุงููุฉ ุนูู ูุนุธู ุงูุชุจุงูู.

ูุญู ูุฐู ุงููุดููุฉ ูุณุชุฎุฏู ุงูุชุญููู ุงููุณูู:

> **Variance Stabilizing Transformation (VST)**  

ููู ูุญููู ุงูููู ุจุญูุซ ูุตุจุญ ุงูุชุจุงูู ุฃูุซุฑ ุชุฌุงูุณูุง ุจูู ุงูุฌููุงุชุ  
ุฃู ุฃู ุงูุฌููุงุช ุฐุงุช ุงูุชุนุจูุฑ ุงูุนุงูู ูุงูููุฎูุถ ุชููุงุฑู ุนูู ููุณ ุงููููุงุณ ุชูุฑูุจูุง.


```{r}
vsd <- vst(dds, blind = FALSE)
```

> ๐ก ุชุนูู  `blind = FALSE` ุฃููุง ูุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ **ุงูุชุตููู ุงูุชุฌุฑูุจู (experimental design)** ุฃุซูุงุก ุงูุชุญูููุ  
> ุฃู ุฃู ุงูุชุญููู ูุชู ุจุทุฑููุฉ ุชุฑุงุนู ุงููุฑูู ุจูู ุงููุฌููุนุงุชุ  
> ููุง ูุฌุนูู ุฃูุซุฑ ููุงุกูุฉ ูุนูููุงุช ุงูุชุตูุฑ **ุจุนุฏ ุงูุชุญููู ุงูุชูุงุถูู**.


### ูุฑุงุกุฉ ุงููุชุงุฆุฌ

ุจุนุฏ ุชูููุฐ ุงูุชุญูููุ ุฃุตุจุญ ูุฏููุง ูุงุฆู ุฌุฏูุฏ ูุณูู **vsd**  
ูุญูู ุงูููู ุงููุญูููุฉ ุจุงุณุชุฎุฏุงู VST ุจุฏูุงู ูู ุงูุนุฏูุงุช ุงูุฎุงู.

ูููููุง ุงุณุชุนุฑุงุถ ุฌุฒุก ูู ุงูุจูุงูุงุช ุงููุญูููุฉ ูููุงุญุธุฉ ุดูููุง ุงูุฌุฏูุฏ:

```{r}
assay(vsd)[1:5, 1:5]
```

ุณุชูุงุญุธ ุฃู ุงูููู ุฃุตุจุญุช **ุนุดุฑูุฉ** ูููุณุช ุนุฏูุงุช ุตุญูุญุฉุ  
ููุฐุง ุทุจูุนู ูุฃู ุงูุชุญููู **ูุณุฑ ุงูุนูุงูุฉ ุงูุฃุตููุฉ ุจูู ุงูุชุจุงูู ูุงููุชูุณุท**ุ  
ููุง ูุฌุนู ุงูุฌููุงุช ุฐุงุช ุงูุชุนุจูุฑ ุงูููุฎูุถ ูุงูุนุงูู ูุงุจูุฉ ููููุงุฑูุฉ ุนูู ููุณ ุงููููุงุณ.


## ููุงุฐุง ูุณุชุฎุฏู VST ุจุฏู log2(count + 1)ุ

ุงูุชุญููู ุงูููุบุงุฑูุชูู ุงูุจุณูุท `log2(count + 1)`  
ููุฎูู ููุท ูู ุงููุฑูู ุงููุจูุฑุฉ ูููู **ูุง ููุตุญูุญ ุงูุชุจุงูู ุจุดูู ูุงูู**ุ  
ุฎุตูุตูุง ููุฌููุงุช ููุฎูุถุฉ ุงูุชุนุจูุฑ.

ุจูููุง ูููู **VST** ุจุชูุฏูุฑ ุงูุนูุงูุฉ ุจูู ุงูุชุจุงูู ูุงููุชูุณุท ูู ุงูุจูุงูุงุช ููุณูุงุ  
ูููุทุจูู ุชุตุญูุญูุง ุฃูุซุฑ ุฏูุฉ ูุฌุนู ุงูุชูุฒูุน ุฃูุซุฑ ุชุฌุงูุณูุง โ  
ููุง ููุญุณูู ุฏูุฉ ุงูุฑุณูู ุงูุฅุญุตุงุฆูุฉ ูุซู **PCA** ู **Heatmap**.


# 7. ุชุญููู ุงูููููุงุช ุงูุฑุฆูุณูุฉ (PCA)

### ๐ก ุงููุฏู ูู ูุฐู ุงูุฎุทูุฉ

ูุณุงุนุฏ ุชุญููู **ุงูููููุงุช ุงูุฑุฆูุณูุฉ (Principal Component Analysis)** ุนูู:

- ุชุจุณูุท ุงูุจูุงูุงุช ุนุงููุฉ ุงูุฃุจุนุงุฏ (ุขูุงู ุงูุฌููุงุช).  
- ุฑุคูุฉ **ุฃููุงุท ุงูุชุฌููุน ุจูู ุงูุนููุงุช**.  
- ุงูุชุดุงู **ุงูุนููุงุช ุงูุดุงุฐุฉ (Outliers)**.  
- ุชูููู ูุฏู ุงูุชุดุงุจู ุจูู ุงูุญุงูุงุช ุงูุชุฌุฑูุจูุฉ (ูุซู ุงููุฑู ููุงุจู ุงูุทุจูุนู).


```{r}
# ุฅุฌุฑุงุก PCA ุนูู ุงูููู ุงููุญูููุฉ (VST)
pca <- prcomp(t(assay(vsd)), center = TRUE, scale. = FALSE)

# ุญุณุงุจ ูุณุจุฉ ุงูุชุจุงูู ุงูููุณููุฑ ูู ุฃูู ูููููู
percentVar <- round(100 * (pca$sdev^2 / sum(pca$sdev^2))[1:2], 1)

# ุชุฌููุฒ ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจุงูุฑุณู
pca_df <- data.frame(
  PC1 = pca$x[, 1],
  PC2 = pca$x[, 2],
  sample = colnames(vsd),
  tissueType = colData(vsd)$tissueType
)

head(pca_df)
```

## 7.1 ุฑุณู ูุฎุทุท PCA

ุจุนุฏ ุญุณุงุจ ููููุงุช PCAุ  
ุณูููู ุงูุขู ุจุฑุณููุง ูุนุฑุถ **ุชุฌููุน ุงูุนููุงุช** ุจูุงุกู ุนูู ุชุดุงุจููุง ูู ุฃููุงุท ุงูุชุนุจูุฑ ุงูุฌููู.

```{r}
# ุฅูุดุงุก ุฑุณู PCA ุจุณูุท ูุชูุถูุญ ุชูุฒูุน ุงูุนููุงุช ุจุนุฏ ุงูุชุญููู (VST)
ggplot(pca_df, aes(PC1, PC2, color = tissueType)) +
  geom_point(size = 3) +  # ุฑุณู ุงูููุงุท ุงูุชู ุชูุซู ุงูุนููุงุช
  labs(
    title = "PCA of Samples after VST Transformation",  # ุนููุงู ุงูุฑุณู
    x = paste0("PC1 (", percentVar[1], "%)"),           # ุชุณููุฉ ุงููุญูุฑ ุงูุณููู
    y = paste0("PC2 (", percentVar[2], "%)")            # ุชุณููุฉ ุงููุญูุฑ ุงูุตุงุฏู
  ) 
```

## 7.2 ูุฑุงุกุฉ ุงููุชุงุฆุฌ ูู ุชุญููู PCA

- ูู ููุทุฉ ุชูุซู **ุนููุฉ ูุงุญุฏุฉ**.  
- ูุฑุจ ุงูุนููุงุช ูู ุจุนุถูุง ูุนูู **ุชุดุงุจู ุฃููุงุท ุงูุชุนุจูุฑ ุงูุฌููู** ุจูููุง.  
- ุงูุชุฌููุน ุงููุงุถุญ ููู ุญุงูุฉ ูุฏู ุนูู **ุงุฎุชูุงู ุจููููุฌู ุญูููู** ุจูู ุงููุฌููุนุงุช.  
- ุฃู ููุทุฉ ุจุนูุฏุฉ ุฌุฏูุง (ุฎุงุฑุฌ ุงูุชุฌูุน) ูุฏ ุชุดูุฑ ุฅูู **ุนููุฉ ุดุงุฐุฉ (Outlier)**.


### ุฎูู ุงูููุงููุณ

ูููู ุชุญููู **PCA** ุจุชุญููู ุขูุงู ุงูุฃุจุนุงุฏ (ุนุฏุฏ ุงูุฌููุงุช) ุฅูู ุนุฏุฏ ูููู ูู **ุงูููููุงุช ุงูุฑุฆูุณูุฉ (Principal Components)**  
ุงูุชู ุชููุฎุต ุฃูุจุฑ ูุฏุฑ ูู ุงูุชุจุงูู ูู ุงูุจูุงูุงุช:

- **PC1** ููุซู ุฃูุจุฑ ูุตุฏุฑ ููุชุจุงูู ูู ุงูุจูุงูุงุช.  
- **PC2** ููุซู ุซุงูู ุฃูุจุฑ ูุตุฏุฑ ููุชุจุงูู.  

> ุนุงุฏุฉู ูู ุจูุงูุงุช **RNA-seq**ุ ูุฐู ุงูููููุงุช ุชุนูุณ ุฅูุง **ุงูุงุฎุชูุงู ุงูุจููููุฌู ุงูุญูููู** ุจูู ุงูุญุงูุงุช  
> ุฃู **ุนูุงูู ุชูููุฉ** ูุซู ุนูู ุงููุฑุงุกุฉ (Library Size).


# 8. ุฑุณู Volcano Plot

### ๐ก ุงููุฏู ูู ูุฐู ุงูุฎุทูุฉ

ููุณุชุฎุฏู **ูุฎุทุท Volcano plot** ูุนุฑุถ ูุชุงุฆุฌ ุงูุชุญููู ุงูุชูุงุถูู ุจุทุฑููุฉ ุชุฌูุน ุจูู:

- **ุญุฌู ุงูุชุฃุซูุฑ** (log2FoldChange) ุนูู ุงููุญูุฑ ุงูุณููู.  
- **ุงูุฃูููุฉ ุงูุฅุญุตุงุฆูุฉ** (-log10(padj)) ุนูู ุงููุญูุฑ ุงูุตุงุฏู.

> ูููุง ุตุนุฏุช ุงูููุทุฉ ููุฃุนูู โฌ๏ธ โ ุฒุงุฏุช ุฃูููุชูุง ุงูุฅุญุตุงุฆูุฉ.  
> ูููุง ุงุจุชุนุฏุช ูููููุง ุฃู ูุณุงุฑูุง โฌ๏ธโก๏ธ โ ูุงู ุงููุฑู ูู ุงูุชุนุจูุฑ ุฃูุจุฑ.


## 8.1 ุชุฌููุฒ ุงูุจูุงูุงุช

```{r}
res_df <- as.data.frame(res) %>%
  rownames_to_column("gene_id") %>%                  # ููู ุฃุณูุงุก ุงูุฌููุงุช ุฅูู ุนููุฏ ุฌุฏูุฏ
  mutate(
    padj = if_else(is.na(padj), 1.0, padj),          # ุชุนููุถ ุงูููู ุงูููููุฏุฉ ูู padj
    neg_log10_padj = -log10(padj),                   # ุญุณุงุจ -log10(padj) ููุฑุณู
    significance = case_when(                        # ุชุญุฏูุฏ ุญุงูุฉ ูู ุฌูู
      padj < 0.05 & log2FoldChange > 1  ~ "Upregulated",
      padj < 0.05 & log2FoldChange < -1 ~ "Downregulated",
      TRUE                              ~ "Not significant"
    )
  )

head(res_df)
```

## 8.2 ุฑุณู ูุฎุทุท Volcano Plot

ุจุนุฏ ุชุฌููุฒ ุฅุทุงุฑ ุงูุจูุงูุงุช (**res_df**)  
ุณูุฑุณู ุงูุขู **ูุฎุทุท ุงูุจุฑูุงู (Volcano Plot)** ุงูุฐู ููุธูุฑ ุงูุฌููุงุช ุงููุชุบูุฑุฉ ูู ุงูุชุนุจูุฑ ุจูู ุงููุฌููุนุชูู.

```{r}
# ุฅูุดุงุก Volcano Plot ูุนุฑุถ ุงูุฌููุงุช ุญุณุจ ุญุฌู ุงูุชุฃุซูุฑ ูุงูุฏูุงูุฉ ุงูุฅุญุตุงุฆูุฉ
ggplot(res_df, aes(x = log2FoldChange, y = neg_log10_padj, color = significance)) +
  geom_point(alpha = 0.75, size = 1.8) +  # ุฑุณู ุงูููุงุท (ูู ููุทุฉ = ุฌูู)
  scale_color_manual(values = c(           # ุชุญุฏูุฏ ุฃููุงู ุงููุฌููุนุงุช
    "Upregulated" = "#E74C3C",             # ุฃุญูุฑ = ูุนุจููุฑ ุฃูุซุฑ ูู ุงููุฑู
    "Downregulated" = "#3498DB",           # ุฃุฒุฑู = ููุฎูุถ ูู ุงููุฑู
    "Not significant" = "grey70"           # ุฑูุงุฏู = ุบูุฑ ูุนููู
  )) +
  geom_vline(xintercept = c(-1, 1), linetype = "dashed", color = "black") +   # ุฎุทูุท ุชุญุฏุฏ ยฑ1 ูู log2FC
  geom_hline(yintercept = -log10(0.05), linetype = "dashed", color = "black") + # ุฎุท ููุฏูุงูุฉ ุงูุฅุญุตุงุฆูุฉ
  labs(
    title = "Volcano Plot: Primary tumor vs Solid tissue normal",  # ุนููุงู ุงูุฑุณู
    x = "Log2 Fold Change",                                        # ุชุณููุฉ ุงููุญูุฑ ุงูุณููู
    y = "-Log10(FDR)",                                             # ุชุณููุฉ ุงููุญูุฑ ุงูุตุงุฏู
    color = "Status"                                               
  ) +
  theme_minimal(base_size = 14) 
```

# 9. ุนุฑุถ ุงูุฌููุงุช ุงูุฃูุซุฑ ุชูุงุถูุงู (Boxplot & Violin)

### ๐ก ุงููุฏู ูู ูุฐู ุงูุฎุทูุฉ

ุจุนุฏ ุชุญุฏูุฏ ุงูุฌููุงุช ุงูุฃูุซุฑ ุงุฎุชูุงููุง ูู ุงูุชุนุจูุฑุ  
ุณูููู ุงูุขู ุจุนุฑุถ **ุฃููุงุท ุงูุชุนุจูุฑ** ูุชูู ุงูุฌููุงุช ุนุจุฑ ุงููุฌููุนุชูู (ุงููุฑู ูุงููุณูุฌ ุงูุทุจูุนู).  
ุณูุฎุชุงุฑ **ุฃุนูู 10 ุฌููุงุช ุชูุงุถูุงู** (ุฃู ุฃูู ูููุฉ padj) ูุนุฑุถูุง ุจุตุฑููุง.

```{r}
top10 <- res_df %>%
  filter(!is.na(padj)) %>%        # ุฅุฒุงูุฉ ุงูููู ุงูููููุฏุฉ ูู ุงูุนููุฏ padj
  arrange(padj) %>%               # ุชุฑุชูุจ ุงูุฌููุงุช ุญุณุจ ุงููููุฉ ุงูุฅุญุตุงุฆูุฉ
  slice_head(n = 10) %>%          # ุงุฎุชูุงุฑ ุฃูู 10 ุฌููุงุช ููุท
  pull(gene_id)                   # ุงุณุชุฎุฑุงุฌ ุฃุณูุงุก ุงูุฌููุงุช

norm_counts <- counts(dds, normalized = TRUE)  # ุงูุญุตูู ุนูู ุงูุนุฏูุงุช ุจุนุฏ normalization

plot_df <- as.data.frame(norm_counts[top10, , drop = FALSE]) %>%  # ุชุญุฏูุฏ ุงูุฌููุงุช ุงูุนุดุฑุฉ ุงูุฃุนูู
  rownames_to_column("gene_id") %>%                               # ุชุญููู ุฃุณูุงุก ุงูุฌููุงุช ุฅูู ุนููุฏ
  pivot_longer(-gene_id, names_to = "sample", values_to = "count") %>%  # ุชุญููู ุงูุฌุฏูู ุฅูู  (long format)
  left_join(                                                      # ุฑุจุท ุงูุจูุงูุงุช ุงููุตููุฉ ุงูุฎุงุตุฉ ุจุงูุนููุงุช
    as.data.frame(colData(dds)) %>% 
      rownames_to_column("sample") %>%
      select(sample, tissueType),
    by = "sample"
  )
plot_df$gene_name <- gene_names[match(plot_df$gene_id, gene_ids)]   # ุฅุถุงูุฉ ุนููุฏ ุจุฃุณูุงุก ุงูุฌููุงุช ุงูููุงุจูุฉ

head(plot_df)
```

## 9.1 Boxplot ููุฌููุงุช ุงูุนุดุฑุฉ ุงูุฃุนูู ุชูุงุถููุง

ุงูุขู ุณูุนุฑุถ ุชูุฒูุน ููู ุงูุชุนุจูุฑ ุงูุฌููู ููุฌููุงุช ุงูุนุดุฑุฉ ุงูุฃุนูู ุชูุงุถููุง  
ุจุงุณุชุฎุฏุงู **Boxplot** ุงูุฐู ููุธูุฑ ุงูููู ุงููุชูุณุทุฉ ูุงูุงูุญุฑุงูุงุช ุฏุงุฎู ูู ูุฌููุนุฉ.

```{r}
# ุชุตููุฉ ุงููุฌููุนุชูู ุงููุทููุจุชูู ููุท + ุนูู ุชุญููู ููุบุงุฑูุชูู ูุณุจููุง
plot_df2 <- plot_df %>%
  dplyr::filter(tissueType %in% c("normal", "primary_tumor")) %>%         # ุฅุจูุงุก normal ู primary_tumor ููุท
  dplyr::mutate(
    tissueType = factor(tissueType, levels = c("normal", "primary_tumor")),# ุชุฑุชูุจ ุซุงุจุช ูููุฌููุนุชูู
    log_count = log10(count + 1)                                           # ุชุญููู ููุบุงุฑูุชูู 
  )

# ุฑุณู Boxplot
ggplot(plot_df2, aes(x = gene_name, y = log_count, fill = tissueType)) +
  geom_boxplot(outlier.shape = NA, alpha = 0.8,                           
               position = position_dodge(width = 0.75)) +                 # ูุตู ุงููุฌููุนุชูู ููู ุฌูู
  geom_jitter(aes(color = tissueType),                                    
              position = position_jitterdodge(jitter.width = 0.2, 
                                              dodge.width  = 0.75),
              size = 1, alpha = 0.5) +
  labs(
    title = "Top 10 DE Genes (Normal vs Primary Tumor)",                  # ุนููุงู ุงูุฑุณู
    x = "Gene",                                                           # ุงููุญูุฑ ุงูุณููู (ุฃุณูุงุก ุงูุฌููุงุช)
    y = "log10(Normalized Counts + 1)",                                   # ุงููุญูุฑ ุงูุตุงุฏู (ุจุนุฏ ุงูุชุญููู)
    fill  = "Tissue Type",                                                
    color = "Tissue Type"                                                 
  ) +
  theme_minimal(base_size = 12) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))                # ุชุฏููุฑ ุฃุณูุงุก ุงูุฌููุงุช ูุณูููุฉ ุงููุฑุงุกุฉ

```

## 9.2 ูุฑุงุกุฉ ูุชุงุฆุฌ Boxplot

- ูู **ุตูุฏูู (Box)** ูู ุงูุฑุณู ููุซู **ุชูุฒูุน ููู ุงูุชุนุจูุฑ ุงูุฌููู** ูุนููุฉ ูุนููุฉ ุถูู ูุฌููุนุฉ ูุญุฏุฏุฉ (ูุซู *Normal* ุฃู *Primary Tumor*).  
- ุงูุฎุท ุงูุฃูุณุท ุฏุงุฎู ุงูุตูุฏูู ูู **ุงููุณูุท (Median)**ุ ุจูููุง ุญูุงู ุงูุตูุฏูู ุชูุซู **ุงูุฑุจุน ุงูุฃูู ูุงูุซุงูุซ (Q1 ู Q3)**.  
- ุฅุฐุง ูุงู ุงูุตูุฏูู ุงูุฎุงุต ุจูุฌููุนุฉ **Primary Tumor** ุฃุนูู ุจูุถูุญ ูู ูุฌููุนุฉ **Normal**ุ ููุฐุง ูุดูุฑ ุฅูู ุฃู ุงูุฌูู **ูุฑุชูุน ุงูุชุนุจูุฑ ูู ุงูุนููุงุช ุงููุฑููุฉ**.  
- ุงูููุงุท ุงููุฑุฏูุฉ ุชูุซู **ููู ุงูุนููุงุช ุงููููุฑุฏุฉ**ุ ูุชุณุงุนุฏ ุนูู ุฑุคูุฉ ุงูุชูุฒูุน ุงููุงูู ููููู.  
- ุงุณุชุฎุฏุงู **ุงููููุงุณ ุงูููุบุงุฑูุชูู** (log10) ูู ุงููุญูุฑ ุงูุตุงุฏู ูุฌุนู ุงููุฑูู ุงูุตุบูุฑุฉ ุฃูุซุฑ ูุถูุญูุง ููููู ูู ุชุฃุซูุฑ ุงูููู ุงููุจูุฑุฉ ุฌุฏูุง.


## 9.3 Violin Plot ููุฌููุงุช ููุณูุง  

ููุถุญ **Violin Plot** ุชูุฒูุน ููู ุงูุชุนุจูุฑ ุงูุฌููู ุจุดูู ุฃูุซุฑ ุชูุตูููุงุ  
ุญูุซ ูุฌูุน ุจูู ุดูู ุงููุซุงูุฉ (Distribution) ูุตูุฏูู ุงูููู (Boxplot)ุ  
ููุง ูุณูุญ ุจููุงุฑูุฉ ุดูู ุชูุฒูุน ุงูููู ุฏุงุฎู ูู ูุฌููุนุฉ (ูุฑู ุฃููู ููุงุจู ูุณูุฌ ุทุจูุนู).

```{r}
# ุฑุณู Violin 
ggplot(plot_df2, aes(x = gene_name, y = log_count, fill = tissueType)) +
  geom_violin(trim = FALSE, alpha = 0.7, position = position_dodge(width = 0.75)) + # ุดูู ุงููุซุงูุฉ ููู ูุฌููุนุฉ
  geom_jitter(aes(color = tissueType),                                              # ููุงุท ุงูุนููุงุช ููู ุงูููุญูู
              position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.75),
              size = 1, alpha = 0.5) +
  labs(
    title = "Top 10 DE Genes (Violin Plot: Normal vs Primary Tumor)",      # ุนููุงู ุงูุฑุณู
    x = "Gene",                                                            # ุงููุญูุฑ ุงูุณููู (ุฃุณูุงุก ุงูุฌููุงุช)
    y = "log10(Normalized Counts + 1)",                                    # ุงููุญูุฑ ุงูุตุงุฏู ุจุนุฏ ุงูุชุญููู
    fill  = "Tissue Type",                                                
    color = "Tissue Type") +
  theme_minimal(base_size = 12) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))                 # ุชุฏููุฑ ุฃุณูุงุก ุงูุฌููุงุช ูุณูููุฉ ุงููุฑุงุกุฉ

```

## 9.4 ูุฑุงุกุฉ ุงููุชุงุฆุฌ  

- ูู **ุตูุฏูู ุฃู ุดูู ููุงู (Violin)** ููุซู ุชูุฒูุน ููู ุงูุชุนุจูุฑ ูุฌูู ูุนููู ุฏุงุฎู ูู ูุฌููุนุฉ ูู ุงูุนููุงุช.  
- ุฅุฐุง ูุงูุช ูุฌููุนุฉ **Primary tumor** ุชูุชูู ููููุง ุฃุนูู ุจูุถูุญุ ููุฐุง ูุนูู ุฃู ูุฐุง ุงูุฌูู **ูุฑุชูุน ุงูุชุนุจูุฑ ูู ุงููุฑู**.  
- ุงุณุชุฎุฏุงู **ุงููููุงุณ ุงูููุบุงุฑูุชูู** ูุฌุนู ุงููุฑูู ุงูุตุบูุฑุฉ ุจูู ุงูููู ุฃูุซุฑ ูุถูุญูุง ุจุตุฑููุง.  


## ๐ ููุฎุต ูุฐู ุงููุฑุญูุฉ  

โจ ูู ูุฐู ุงููุฑุญูุฉ ูููุง ุจู:  

1. **ุชุญููู ุงูุจูุงูุงุช** ูุชุตุญูุญ ุงูุชุจุงูู (VST).  
2. **ุชุญููู ุงูุนูุงูุงุช** ุจูู ุงูุนููุงุช ุนุจุฑ PCA.  
3. **ุนุฑุถ ุงูุฌููุงุช ุงูุชูุงุถููุฉ** ุนุจุฑ Volcano plot.  
4. **ุฏุฑุงุณุฉ ุงูุฌููุงุช ุงููููุฉ** ุนุจุฑ Boxplot ูViolin plot.  

> โ ุงููุชูุฌุฉ: ุฃุตุจุญ ูุฏููุง **ููู ุจุตุฑู ุดุงูู ูููุฑูู** ุจูู ุงูุนููุงุช ูุงูุฌููุงุช.  
> ุณููุชูู ุงูุขู ุฅูู ุงููุฑุญูุฉ ุงูุชุงููุฉ: **ุชุญููู Functional Enrichment Analysis  (GO - Reactome)** ูููู ุงููุธุงุฆู ูุงููุณุงุฑุงุช ุงููุชุฃุซุฑุฉ ุจูุฐู ุงูุฌููุงุช   


# 10. Functional Enrichment Analysis 

ุจุนุฏ ุฃู ุชุนุฑููุง ุนูู ุงูุฌููุงุช ุงููุชุบุงูุฑุฉ ูู ุงูุชุนุจูุฑุ ููุชูู ุงูุขู ููุณุคุงู ุงูุฃูู:  
 *ูุง ูู ุงููุธุงุฆู ุงูุญูููุฉ ูุงููุณุงุฑุงุช ุงูุชู ุชุชุฃุซุฑ ุจูุฐู ุงูุฌููุงุชุ*  


## 10.1 ููุฏูุฉ ุนู Functional Enrichment Analysis 

ุจุนุฏ ุฃู ูุญุตู ุนูู ูุงุฆูุฉ ุงูุฌููุงุช ุงูุชู ุฃุธูุฑุช ูุฑูููุง ูุนูููุฉ ูู ุงูุชุนุจูุฑุ  
ูุญุชุงุฌ ุฃู ูููู **ุงููุบุฒู ุงูุจููููุฌู** ูุฑุงุก ูุฐู ุงูุฌููุงุช.  
ูู ุชุฑุชุจุท ุจูุธุงุฆู ูุนููุฉุ ูู ุชุดุงุฑู ูู ูุณุงุฑุงุช ุฃูุถูุฉ  ูุญุฏุฏุฉุ  

ุชุญููู  (**Functional Enrichment Analysis**) ูู ูุง ูุฌูุจ ุนู ูุฐุง ุงูุณุคุงู.  


## 10.2 ๐ก ููู ููุฑุฃ ูุชุงุฆุฌ GO ูKEGG ูReactome ููุง ุงููุฑู ุจููููุงุ  

| ุงููุงุนุฏุฉ | ุงููุนูู | ุงูุบุฑุถ |
|----------|---------|--------|
| **Gene Ontology (GO)** | ุชุตููู ุดุงูู ูููุธุงุฆู ุงูุฌูููุฉ. ูููุณู ุฅูู ุซูุงุซ ูุฆุงุช: 1. Biological Process (BP) โ ุงูุนูููุงุช ุงูุญูููุฉุ 2. Molecular Function (MF) โ ุงููุธุงุฆู ุงูุฌุฒูุฆูุฉุ 3. Cellular Component (CC) โ ุงูููุงูุน ุงูุฎูููุฉ. | ูุตู "ูุง ุงูุฐู ููุนูู ุงูุฌูู ูุฃูู ูููุงุฐุง". |
| **KEGG Pathways** | ูุงุนุฏุฉ ุจูุงูุงุช ูููุณุงุฑุงุช ุงูุฃูุถูุฉ ุงููุนุฑููุฉ. ูู ูุณุงุฑ ูุถู ูุฌููุนุฉ ูู ุงูุฌููุงุช ุงููุชูุงุนูุฉ. | ููุถุญ "ููู ุชุนูู ุงูุฌููุงุช ูุนูุง ุถูู ุดุจูุฉ ูุงุญุฏุฉ". |
| **Reactome** | ูุงุนุฏุฉ ุจูุงูุงุช ููุธูุฉ ูููุณุงุฑุงุช ุงูุญูููุฉ ุงููุนุชูุฏุฉ ุนูู ุงูุฃุฏูุฉ ูู ุงูุฃุจุญุงุซ ูุงูุชุฌุงุฑุจ ุงููุนูููุฉุ ุชุฑูุฒ ุนูู ุงูุชูุงุนูุงุช ุงูุฌุฒูุฆูุฉ ุงูุฏูููุฉ ูุงูุนูููุงุช ุงูุฎูููุฉ ุงูููุตูุฉ. | ุชุณุงุนุฏ ุนูู ููู "ุงูุชุณูุณู ุงูุฏููู ููุฃุญุฏุงุซ ุงูุจููููุฌูุฉ ุฏุงุฎู ุงูุฎููุฉ" ูุชูุนุฏ ุฃูุซุฑ ุชูุตููุงู ูู KEGG. |


> โจ ุงููุฑู ุงูุฃุณุงุณู:  
> **GO** ุชุตู *ุงููุธุงุฆู ุงููุฑุฏูุฉ ููุฌููุงุช*.  
> **KEGG** ุชุตู *ุงูุนูุงูุงุช ูุงููุณุงุฑุงุช ุงููุดุชุฑูุฉ ุจูู ุงูุฌููุงุช*.  
> **Reactome** ุชุดุฑุญ *ุงูุฎุทูุงุช ุงูุชูุตูููุฉ ููุชูุงุนูุงุช ุฏุงุฎู ุงููุณุงุฑุงุช ุงูุฎูููุฉ*ุ ูุบุงูุจูุง ุชููู ุฃูุซุฑ ุฏูุฉ ูุชูุตููุงู ูู KEGG.


## 10.3 ุงูุฎุทูุฉ ุงูุฃููู: ุงุฎุชูุงุฑ ุงูุฌููุงุช ุงููููุฉ  

```{r select-sig}
sig_genes <- res_df %>%
  filter(padj < 0.05, abs(log2FoldChange) > 1) %>%        # ุงุฎุชูุงุฑ ุงูุฌููุงุช ุฐุงุช ุฏูุงูุฉ ุฅุญุตุงุฆูุฉ ููุฑูู ูุงุถุญุฉ
  mutate(gene_id = str_replace(gene_id, "\\.\\d+$", "")) %>%  # ุฅุฒุงูุฉ ุงูุฑููุฒ  ูู ูุนุฑูุงุช Ensembl
  pull(gene_id)                                            # ุงุณุชุฎุฑุงุฌ ุฃุณูุงุก ุงูุฌููุงุช ููุท

length(sig_genes)                                          # ุนุฑุถ ุนุฏุฏ ุงูุฌููุงุช ุงููููุฉ
```

๐ก ูู ูุฐู ุงูุฎุทูุฉ ูุฎุชุงุฑ ุงูุฌููุงุช ุงูุชู ุชูุชูู **ุฏูุงูุฉ ุฅุญุตุงุฆูุฉ ูููุฉ**  
(`padj < 0.05`) ููุฑูููุง ูุงุถุญุฉ ูู ูุณุชูู ุงูุชุนุจูุฑ (`|log2FC| > 1`).  


## 10.4 ุชุญููู ูุนุฑูุงุช ุงูุฌููุงุช ุฅูู ENTREZ  

ุงูุชุญููู  ุจุงุณุชุฎุฏุงู ููุชุจุฉ **clusterProfiler** ูุนุชูุฏ ุนูู ูุนุฑูุงุช  
**Entrez Gene IDs** ูููุณ **Ensembl IDs**ุ  
ูุฐูู ูุฌุจ ุชุญููู ุงููุนุฑูุงุช ุฃูููุง ุจุงุณุชุฎุฏุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช **org.Hs.eg.db** ุงูุฎุงุตุฉ ุจุงูุฅูุณุงู.

```{r}
entrez_ids <- AnnotationDbi::mapIds(
  org.Hs.eg.db,               # ูุงุนุฏุฉ ุจูุงูุงุช ุงูุฌููุงุช ุงูุจุดุฑูุฉ
  keys = sig_genes,            # ูุงุฆูุฉ ุงูุฌููุงุช ุงููุฎุชุงุฑุฉ ูู ูุชุงุฆุฌ DESeq2
  column = "ENTREZID",         # ููุน ุงููุนุฑู ุงููุทููุจ ุงูุญุตูู ุนููู
  keytype = "ENSEMBL",         # ููุน ุงููุนุฑู ุงูุญุงูู ุงููุณุชุฎุฏู ูู ุงููุงุฆูุฉ
  multiVals = "first"          # ุฅุฐุง ููุฌุฏ ุฃูุซุฑ ูู Entrez ID ููุฌููุ ูุฃุฎุฐ ุงูุฃูู ููุท
)

entrez_ids <- na.omit(entrez_ids)  # ุฅุฒุงูุฉ ุฃู ููู ููููุฏุฉ (ุฌููุงุช ุจุฏูู ูุนุฑู Entrez)
length(entrez_ids)                 # ุนุฑุถ ุนุฏุฏ ุงูุฌููุงุช ุงูุชู ุชู ุชุญููููุง ุจูุฌุงุญ
```

## 10.5 ุชูููุฐ ุชุญููู GO (Biological Process)

ุงูุขู ุจุนุฏ ุฃู ุฃุตุจุญ ูุฏููุง ูุนุฑูุงุช ุงูุฌููุงุช ุจุตูุบุฉ **ENTREZ IDs**ุ  
ุณูููู ุจุชูููุฐ **(GO Enrichment Analysis)**  
ุจุงุณุชุฎุฏุงู ููุชุจุฉ **clusterProfiler** ูุชุญุฏูุฏ ุงูุนูููุงุช ุงูุญูููุฉ (Biological Processes)  
ุงูุชู ุชุญุชูู ุนูู ุนุฏุฏ ูุจูุฑ ูู ุงูุฌููุงุช ุงููุชุบูุฑุฉ ูู ุงูุชุนุจูุฑ.

```{r}
ego <- enrichGO(
  gene = entrez_ids,           # ูุงุฆูุฉ ุงูุฌููุงุช ุงููููุฉ ุจุตูุบุฉ Entrez IDs
  OrgDb = org.Hs.eg.db,        # ูุงุนุฏุฉ ุจูุงูุงุช ุงูุฌููุงุช ุงูุฎุงุตุฉ ุจุงูุฅูุณุงู
  keyType = "ENTREZID",        # ููุน ุงููุนุฑูู ุงููุณุชุฎุฏู
  ont = "BP",                  # ููุน ุชุตููู GO: Biological Process
  pvalueCutoff = 0.05,         # ุงูุญุฏ ุงูุฃูุตู ูููููุฉ ุงูุงุญุชูุงููุฉ ูุจู ุงุนุชุจุงุฑ ุงููุชูุฌุฉ ูููุฉ
  pAdjustMethod = "BH",        # ุทุฑููุฉ ุชุตุญูุญ ุงูููู ุงูุงุญุชูุงููุฉ (Benjamini-Hochberg)
  readable = TRUE              # ุชุญููู ุงููุนุฑูุงุช ุฅูู ุฃุณูุงุก ุฌููุงุช ูููููุฉ ูููุฑุงุกุฉ
)

go_df <- as.data.frame(ego)    # ุชุญููู ูุชุงุฆุฌ GO ุฅูู ุฅุทุงุฑ ุจูุงูุงุช ูุณูููุฉ ุงููุนุงูุฌุฉ
head(go_df)                    # ุนุฑุถ ุฃูู 6 ุตููู ูู ุงููุชุงุฆุฌ
```

## 10.6 ุฑุณู ูุชุงุฆุฌ GO โ Barplot  

ุงูุขู ุณูููู ุจุฑุณู **ุฃูู ุงูุนูููุงุช ุงูุญูููุฉ (GO terms)**  
ุงูุชู ุฃุธูุฑุช ุชุบููุฑ ูุนููู ูู ูุฌููุนุฉ ุงูุฌููุงุช ุงููุชุบุงูุฑุฉ ูู ุงูุชุนุจูุฑ.  
ููุซู ูุฐุง ุงูุฑุณู ุนุฏุฏ ุงูุฌููุงุช ุงููุดุงุฑูุฉ ูู ูู ุนูููุฉ ุญูููุฉ (Count)ุ  
ูููููููู ุญุณุจ ุฏุฑุฌุฉ ุงูุฃูููุฉ ุงูุฅุญุตุงุฆูุฉ (**p.adjust**).

```{r}
# ุฑุณู ุฃูู ุงูุนูููุงุช ุงูุญูููุฉ (GO terms) ุงูุบููุฉ ุจุงูุฌููุงุช ุงููุชุบุงูุฑุฉ
barplot(
  ego,                          #  ูุงุชุฌ ูู enrichGO()
  showCategory = 15,            # ุนุฑุถ ุฃุนูู 15 ุนูููุฉ ุญูููุฉ ููุท
  title = "GO Enrichment (Biological Process)",  # ุนููุงู ุงูุดูู
  font.size = 12,               # ุญุฌู ุงูุฎุทูุท ุฏุงุฎู ุงูุฑุณู
  xlab = "Number of Genes",     # ุชุณููุฉ ุงููุญูุฑ ุงูุณููู 
  color = "p.adjust"            # ุชูููู ุงูุฃุนูุฏุฉ ุญุณุจ ูููุฉ  p.adjust
)                 
```

## 10.7 ุฑุณู ูุชุงุฆุฌ GO โ Dotplot  

ููุถูุญ **Dotplot** ูุชุงุฆุฌ ุชุญููู GO ุจุทุฑููุฉ ุชุฌูุน ุจูู  
ุนุฏุฏ ุงูุฌููุงุช ุงููุดุงุฑูุฉ (**Count**) ููุณุจุฉ ุงูุฌููุงุช ุถูู ูู ุนูููุฉ (**GeneRatio**)  
ูุน ุชูููู ุงูููุงุท ุจุญุณุจ ูุณุชูู (**p.adjust**).  
ูู ููุทุฉ ุชูุซู ุนูููุฉ ุญูููุฉ (Biological Process).

```{r}
# ุฑุณู Dotplot ูุฃูู ุงูุนูููุงุช ุงูุญูููุฉ (GO terms)
dotplot(
  ego,                           #  ุงููุงุชุฌ ูู enrichGO()
  showCategory = 15,             # ุนุฑุถ ุฃุนูู 15 ุนูููุฉ ุญูููุฉ
  title = "GO Enrichment (Biological Process)",  # ุนููุงู ุงูุฑุณู
  font.size = 12
)               
```

## 10.8 ูุฑุงุกุฉ ุงููุชุงุฆุฌ  

- ูู ุตู ูู ุงูุฌุฏูู ููุซู **ุนูููุฉ ุญูููุฉ (Biological Process)** ุชุญุชูู ุนูู ุนุฏุฏ ูุจูุฑ ูู ุงูุฌููุงุช ุงููุชุบูุฑุฉ ูู ุงูุชุนุจูุฑ.  
- ูููุง **ุฒุงุฏ ุนุฏุฏ ุงูุฌููุงุช (Count)** ู**ุงูุฎูุถุช ูููุฉ p.adjust**ุ ุฒุงุฏุช ุฃูููุฉ ูุฐู ุงูุนูููุฉ ุงูุญูููุฉ.  
- ุงูููุงุท ุงููุจูุฑุฉ ูู ุงูุฑุณู (Dotplot) ุชูุซู ุนูููุงุช ุชุดูู ุนุฏุฏูุง ุฃูุจุฑ ูู ุงูุฌููุงุช ุงููุชุฃุซุฑุฉ.  


## 10.9 ุชูููุฐ ุชุญููู Reactome  

ุงูุขู ุณููููุฐ ุชุญููู **ReactomePA**  
ูุชุญุฏูุฏ **ุงููุณุงุฑุงุช ุงูุญูููุฉ (biological pathways)** ุงูุชู ุชุชุฃุซุฑ ุจุงูุฌููุงุช ุงููุชุบูุฑุฉ ูู ุงูุชุนุจูุฑ.  
ูุฑููุฒ ูุฐุง ุงูุชุญููู ุนูู **ุงูุชูุงุนูุงุช ุงูุฌุฒูุฆูุฉ ุงูุฏูููุฉ** ูุงูุนูููุงุช ุงูุฎูููุฉ ุถูู ุดุจูุฉ ุชูุงุนูุงุช ุดุงููุฉ ูุจููุฉ ุนูู ูุงุนุฏุฉ ุจูุงูุงุช **Reactome**ุ  
ููุง ูุณุงุนุฏ ุนูู ููู **ููู ุชุณุงูู ุงูุฌููุงุช ูุนูุง ูู ุชูููุฐ ุงูุนูููุงุช ุงูุญูููุฉ ุฏุงุฎู ุงูุฎููุฉ**.


```{r}
ereact <- enrichPathway(
  gene = entrez_ids,
  organism = "human",
  pvalueCutoff = 0.05,
  readable = TRUE
)

ereact_df <- as.data.frame(ereact) # ุชุญููู ุงููุชุงุฆุฌ ุฅูู ุฅุทุงุฑ ุจูุงูุงุช
head(ereact_df)                   # ุนุฑุถ ุฃูู 6 ุตููู   
```

## 10.10 ุฑุณู ูุชุงุฆุฌ KEGG  

ููุธูุฑ ูุฐุง ุงูุฑุณู **ุฃูู ุงููุณุงุฑุงุช ุงูุฃูุถูุฉ ุฃู  (Pathways)**  
ุงูุชู ุชุถู ุนุฏุฏูุง ูุจูุฑูุง ูู ุงูุฌููุงุช ุงููุชุบูุฑุฉ ูู ุงูุชุนุจูุฑ ุงูุฌููู.  
ูุชู ุชุฑุชูุจ ุงููุณุงุฑุงุช ุญุณุจ ุนุฏุฏ ุงูุฌููุงุช ุงููุดุงุฑูุฉ ูููุง (**Count**)  
ูุน ุชุฏุฑูุฌ ูููู ูุนุจูุฑ ุนู **ูุณุชูู ุงูุฏูุงูุฉ ุงูุฅุญุตุงุฆูุฉ (p.adjust)**.

```{r}
# Barplot: ุนุฑุถ ุฃูู ุงููุณุงุฑุงุช ุงูุฃูุถูุฉ ุญุณุจ ุนุฏุฏ ุงูุฌููุงุช
barplot(ereact, 
        showCategory = 15,                 # ุนุฑุถ ุฃุนูู 15 ูุณุงุฑูุง ููุท
        title = "Reactome Pathway Enrichment", # ุนููุงู ุงูุฑุณู
        font.size = 12)                    # ุญุฌู ุงููุตูุต
```

```{r}
# Dotplot: ุนุฑุถ ุงููุณุงุฑุงุช ูุน ุชูุถูุญ ูุณุจุฉ ุงูุฌููุงุช ูุงูุฏูุงูุฉ ุงูุฅุญุตุงุฆูุฉ
dotplot(ereact, 
        showCategory = 15,                 # ุนุฑุถ ุฃุนูู 15 ูุณุงุฑูุง
        title = "Reactome Pathway Enrichment", 
        font.size = 12)
```


## 10.11 ูุฑุงุกุฉ ุงููุชุงุฆุฌ  

- ููุซู ูู ุตู ูู ุฌุฏูู **Reactome** ูุณุงุฑูุง ุฃูุถููุง ูุญุชูู ุนูู ุนุฏุฏ ูู ุงูุฌููุงุช ุงููุชุบุงูุฑุฉ ูู ุงูุชุนุจูุฑ.  
- ุงูุฎูุงุถ ูููุฉ **p.adjust** ูุดูุฑ ุฅูู ุฃู ูุฐุง ุงููุณุงุฑ ุฃูุซุฑ ุงุญุชูุงููุง ุฃู ูููู ูุฑุชุจุทูุง ุจุงููุฑุถ ุฃู ุงูุธุงูุฑุฉ ููุฏ ุงูุฏุฑุงุณุฉ.  
- ุฃูุซูุฉ ุดุงุฆุนุฉ ูุฏ ุชุธูุฑ ูู ูุซู ูุฐู ุงูุชุญูููุงุช:  
  *Cell cycle*, *p53 signaling*, *Metabolic pathways*.


## ๐ ููุฎุต ูุฐู ุงููุฑุญูุฉ  

โจ ูู ูุฐุง ุงูุฌุฒุก ุชุนูููุง:

| ุงููุฑุญูุฉ | ูุง ุชุนูููุงู | ุงูุฃุฏูุงุช ุงููุณุชุฎุฏูุฉ |
|----------|-------------|--------------------|
| **ุชุญููู ุงููุนุฑูุงุช** | ููููุฉ ุชุญููู ุงูุฌููุงุช ุงููููุฉ ุฅูู ูุนุฑูุงุช Entrez ุตุงูุญุฉ ููุชุญููู | `AnnotationDbi` |
| **ุชุญููู ุงูุฅุซุฑุงุก** | ุชูููุฐ ุชุญูููู **GO** ู **Reactome** ูููู ุงููุนุงูู ุงูุจููููุฌูุฉ ููุฌููุงุช ุงููุชุบุงูุฑุฉ | `clusterProfiler` |
| **ุงูุชุตูุฑ ุงูุจูุงูู** | ุนุฑุถ ุงููุชุงุฆุฌ ุจุทุฑููุฉ ุชูุงุนููุฉ ููุงุถุญุฉ ุจุงุณุชุฎุฏุงู **ggplot2** | `ggplot2` |


# ๐ ุฎุงุชูุฉ ุงููุฑุดุฉ  

## ๐ก ููุฎุต ูุง ุชุนูููุงู ุฎูุงู ุงูููู  

| ุงููุฑุญูุฉ | ูุง ุชุนูููุงู | ุงูุฃุฏูุงุช ุงููุณุชุฎุฏูุฉ |
|----------|-------------|--------------------|
| **ูุฑุงุกุฉ ุงูุจูุงูุงุช** | ููู ูููุงุช  (**counts**) ูููู  (**metadata**) ูุฑุจุทููุง ูุนูุง | tidyverse |
| **ุชุตููุฉ ุงูุฌููุงุช** | ุฅุฒุงูุฉ ุงูุฌููุงุช ููุฎูุถุฉ ุงูุชุนุจูุฑ ูุชูููู ุงูุถุฌูุฌ ูุชุญุณูู ุฏูุฉ ุงูุชุญููู | base R |
| **ุงูุชุญููู ุงูุชูุงุถูู** | ููุงุฑูุฉ ุงููุฌููุนุงุช ุจุงุณุชุฎุฏุงู ูููุฐุฌ **DESeq2** | DESeq2 |
| **ุงูุชุตูุฑ ุงูุจูุงูู** | ุชุญููู **PCA** ู **Volcano** ู **Box/Violin plots** | ggplot2 |
| **Functional Enrichment** | ุฅุฌุฑุงุก ุชุญููู **Functional Enrichment (GO and Reactome)** ูุชูุณูุฑ ุงูุนูููุงุช ูุงููุณุงุฑุงุช ุงูุญูููุฉ ุงููุชุฃุซุฑุฉ | clusterProfiler |


# ุงูุชุทุจููุงุช ุงูุนูููุฉ  

ูู ููุงูุฉ ุงููุฑุดุฉุ ูุฑุฌู ูููู ุชุทุจูู ูุง ุชุนููุชููู ุนููููุง  
ูู ุฎูุงู ุชูููุฐ ููุงุฑูุฉ ุฌุฏูุฏุฉ ุจูู:  
> **Primary tumor vs Metastatic liver tissue**

ุงููุฏู ูู ูุฐู ุงูุชูุงุฑูู ูู **ุชุนุฒูุฒ ุงูููู ุงูุชุทุจููู** ููู ุฎุทูุฉ ุชู ุชูููุฐูุง ูู ุงููุฑุดุฉ.  
ูููู ููู ูุฌููุนุฉ ุงุฎุชูุงุฑ **ุฃุญุฏ ุงูููุงู ุงูุชุงููุฉ** ูุฅูุฌุงุฒูุง ุฎูุงู ุงูุฌูุณุฉ ุงูุนูููุฉ:


### ุงูููุงู ุงูููุชุฑุญุฉ  

1. **ุฅุณูุงุท ุงูุนููุฉ ุงูุดุงุฐุฉ ูุฅุนุงุฏุฉ ุฑุณู ุงูู PCA**  
- ุญุฏุฏ ุงูุนููุฉ ุงูุฎุงุฑุฌุฉ ุนู ุงูุชุฌูุน ุงูุนุงู (Outlier) ูู ูุฎุทุท PCA.  
- ุงุณุชุจุนุฏูุง ูุฃุนุฏ ุฑุณู ุงูู PCA ุจุงุณุชุฎุฏุงู ุงูุจูุงูุงุช ุงููุชุจููุฉ.  
- ูุงูุด ููู ุชุบููุฑ ุชูุฒูุน ุงูุนููุงุช ุจุนุฏ ุงูุฅุฒุงูุฉ.  


2. **ุฑุณู Volcano Plot ููููุงุฑูุฉ ุงูุฌุฏูุฏุฉ**  
- ุงุณุชุฎุฏู ููุณ ุฎุทูุงุช ุงูุชุญููู ุงูุชูุงุถูู ููู ููููุงุฑูุฉ:  
  `Metastatic liver tissue` ููุงุจู `Primary tumor`.  
- ุงุฑุณู Volcano Plot ุฌุฏูุฏูุง ููุณูุฑ ุงูุฌููุงุช ุงูุฃูุซุฑ ุชุบููุฑูุง.  


3. **ุฑุณู Boxplot ูุฃูุซุฑ 10 ุฌููุงุช ุชูุงุถููุง**  
- ุงุฎุชุฑ ุฃุนูู 10 ุฌููุงุช ุฐุงุช ุฃูู ูููุฉ `padj`.  
- ุงุฑุณู Boxplot ููุชุนุจูุฑ ุงูุฌููู ูุชูู ุงูุฌููุงุช ุจูู ุงููุฌููุนุชูู.  
- ุงุณุชุฎุฏู ูููุงุณ `log10` ูููุญูุฑ ุงูุนููุฏู ูุชุณููู ุงูููุงุฑูุฉ.  


4. **ุชูููุฐ ุชุญููู GO (ูุฌููุงุช Upregulated ููุท)**  
- ุงุณุชุฎุฑุฌ ุงูุฌููุงุช ุงูุชู **padj < 0.05** ู**log2FC > 1**.  
- ูููุฐ ุชุญููู GO ุนูููุง ููุท ุจุงุณุชุฎุฏุงู `enrichGO()`.  
- ุงุนุฑุถ ุงููุชุงุฆุฌ ูู **Barplot** ููุงูุด ุฃูู ุงูุนูููุงุช ุงูุญูููุฉ ุงููุชุฃุซุฑุฉ.  


5. **ุชูููุฐ ุชุญููู KEGG ูููุงุฑูุฉ ุฃูู 5 ูุณุงุฑุงุช**  
- ูููุฐ ุชุญููู `enrichKEGG()` ูููุณ ุงูุฌููุงุช ุงูุณุงุจูุฉ.  
- ูุงุฑู ุจูู **ุฃูู 5 ูุณุงุฑุงุช** ูู KEGG ููุชุงุฆุฌ GO ุงูุณุงุจูุฉ.  


# ๐ ูุตุงุฏุฑ ุฅุถุงููุฉ ูููุฑุงุกุฉ  

| ุงููุตุฏุฑ | ุงููุตู |
|---------|--------|
| ๐ [DESeq2 documentation](https://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html) | ุฏููู ุงุณุชุฎุฏุงู ููุชุจุฉ DESeq2 ุงูุฑุณููุฉ |
| ๐ [clusterProfiler manual](https://yulab-smu.top/biomedical-knowledge-mining-book/) | ุดุฑุญ ููุตู ูุชุญููู GO ูKEGG |
| ๐ [RNA-seq analysis guide](https://hbctraining.github.io/Intro-to-bulk-RNAseq/schedule/links-to-lessons.html) | ุฏูุฑุฉ ุชุฏุฑูุจูุฉ ููุชูุญุฉ ูู ุชุญููู RNA-seq |
| ๐ [Introduction to ggplot2](https://ggplot2.tidyverse.org/) | ูุฑุฌุน ูุชุฎุตูุต ุงูุฑุณููุงุช ุจุงุณุชุฎุฏุงู ggplot2 |


# โจ ุฎุชุงู ุงููุฑุดุฉ  

๐ **ุงูุชูุช ูุฑุดุฉ ุงูููู ุจูุฌุงุญ!**  

ูู ูุฐู ุงููุฑุดุฉ ุชุนููููุง ููู ููุชูู ูู **ุจูุงูุงุช counts ุงูุฎุงู**  
ุฅูู **ุชูุณูุฑ ุจููููุฌู ูุชูุงูู** ููุถุญ ูุนูู ุงูุชุบููุฑุงุช ูู ุงูุชุนุจูุฑ ุงูุฌููู.  

> ๐ก ูููู ููู ุฎุทูุฉ ูู ุงูุชูุธูู ุฅูู ุงูุชุญููู ุงูุฅุญุตุงุฆู ุซู ุงูุชูุณูุฑ ุ  
> ูู ูุง ูุฌุนูู ูุงุฏุฑูุง ุนูู ุชูููุฐ ุชุญูููุงุช RNA-seq ุจุซูุฉ ูุงุญุชุฑุงููุฉ.

ูุชููู ุฃู ุชููู ูุฐู ุงูุชุฌุฑุจุฉ ูุฏ ุฃุถุงูุช ูู ูุนุฑูุฉ ุนูููุฉ ูุงุถุญุฉ  
ูุฃู ุชุณุงุนุฏู ุนูู ุชุญููู ุจูุงูุงุชู ุงูุจุญุซูุฉ ุงููุงุฏูุฉ ุจุณูููุฉ ุฃูุจุฑ.
